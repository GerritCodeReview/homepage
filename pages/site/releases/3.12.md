---
title: "Gerrit 3.12.x"
permalink: 3.12.html
hide_sidebar: true
hide_navtoggle: true
toc: true
---

Download: **[3.12.4](https://gerrit-releases.storage.googleapis.com/gerrit-3.12.4.war)**
| [3.12.3](https://gerrit-releases.storage.googleapis.com/gerrit-3.12.3.war)
| [3.12.2](https://gerrit-releases.storage.googleapis.com/gerrit-3.12.2.war)
| [3.12.1](https://gerrit-releases.storage.googleapis.com/gerrit-3.12.1.war)
| [3.12.0](https://gerrit-releases.storage.googleapis.com/gerrit-3.12.0.war)

Documentation: **[3.12.4](https://gerrit-documentation.storage.googleapis.com/Documentation/3.12.4/index.html)**
| [3.12.3](https://gerrit-documentation.storage.googleapis.com/Documentation/3.12.3/index.html)
| [3.12.2](https://gerrit-documentation.storage.googleapis.com/Documentation/3.12.2/index.html)
| [3.12.1](https://gerrit-documentation.storage.googleapis.com/Documentation/3.12.1/index.html)
| [3.12.0](https://gerrit-documentation.storage.googleapis.com/Documentation/3.12.0/index.html)

## Release highlights

### Java 21

The language level used for Gerrit source code is set to Java 21, matching its distributed code level
since [Gerrit v3.11](https://www.gerritcodereview.com/3.11.html#java-21).

It is now mandatory to migrate the Java Virtual Machine to Java 21 and there is no possibility to
rebuild Gerrit source code with Java 17 anymore. Also, all the non-core plugins need to be rebuilt
and verified with Java 21; existing Java 17 plugins may not load or work properly.

### Gitattributes configuration support in JGit merge driver

Gerrit now supports gitattributes with merge driver configuration, introduced in
[Change 441721](https://gerrit-review.googlesource.com/c/gerrit/+/441721).

When Gerrit performs server-side merges, it now supports reading and processing [gitattributes](https://git-scm.com/docs/gitattributes.html#_built_in_merge_drivers)
from the global, repo, and in-tree gitattributes files.

The support of gitattributes is implemented for the built-in `binary`
and `union` merge drivers.

### Allow global site-wide override for label's copyCondition

There are two new config variables introduced with [Change 446062](https://gerrit-review.googlesource.com/c/gerrit/+/446062):

- `label.<name>.labelCopyEnforcement`
  for enforcing an additional copy condition for all labels on all projects

- `label.<name>.labelCopyRestriction`
  for reducing forcibly any copy condition for all labels on all projects

When the two settings are defined in `gerrit.config`, then for every project, the final
copyCondition is equivalent to `(<labelCondition> AND NOT <copyRestriction>) OR <copyEnforcement>`

This new behaviour is covered by the experiment feature flag
`GerritBackendFeature__enable_central_override_for_code_review_copy_condition`.

Example of `labelCopyEnforcement` is making sure all negative votes are copied; similarly
`labelCopyRestriction` could be used for making sure only trusted contributors are allowed to submit
changes without reviewers re-confirming that their comments have been addressed.

### Introduce group deletion functionality

It is possible to allow users to delete groups through a new `deleteGroup` global capability.
All the users and groups with the new capability, will have access to the delete group REST-API that
allow to remove Gerrit groups.

In order for a group to be deleted, there are some prerequisites that need to be satisfied:

- The given group is not a system group
- The given group is an internal group (it is assumed that we will not
  allow to delete external groups)
- The given group is not the owner of any other group(s)
- The given group is not used in any ref permissions for any projects

### New H2 v2 storage backend for persistent caches

The H2 library is upgraded to v2 which provides fully multi-threaded operations
and a lower memory footprint, as presented in the [GerritMeets of March 2025](https://youtu.be/T2ApofhyF10?feature=shared).
Migrating from H2 to H2 v2 requires either the rebuild of the persistent caches
from scratch or the execution of a [migration tool](https://github.com/manticore-projects/H2MigrationTool)
to translate the legacy cache files to the new format.

> **NOTE**: Please check the [Known Issues](#known-issues) section to be aware
> of potential problems introduced by this update.

## Contributors

Gerrit 3.12 has had a total of 55 contributors, of which 7 first-time contributors:
- Fredde Ribeiro
- Jade Lovelace
- John Soo
- Pavel Valodzka
- Tran Tuan Khai Phan
- Zhechen Yan
- Narendra Kumar

## Important Notes

### Schema and index changes

Gerrit schema version is unchanged; however, because of the Lucene library bump
to 10.1.0, the on-line upgrade is possible only from Gerrit v3.11 and not from
earlier releases.

All the indexes versions have been increased therefore requiring a reindex:
- `accounts` index version updated to `15`.
- `changes` index version updated to `87`.
- `groups` index version updated to `12`.
- `projects` index version updated to `10`.

### Offline upgrade

- Download the new `gerrit.war`
- Stop Gerrit
- Backup the existing indexes in case a rollback is required
- Ensure all installed plugins are compatible with the new API
- Run init `java -jar gerrit.war init -d site_path --batch`
- Reindex all indexes:

  `java -jar gerrit.war reindex -d site_path`

  See the
  [reindex](https://gerrit-documentation.storage.googleapis.com/Documentation/3.12.2/pgm-reindex.html)
  command for other options.

### Online upgrade with zero-downtime

Gerrit v3.12.x supports zero-downtime upgrade from Gerrit v3.11 when configured
using either
[high-availability](https://gerrit.googlesource.com/plugins/high-availability/+/refs/heads/master/README.md)
or
[multi-site](https://gerrit.googlesource.com/plugins/multi-site/+/refs/heads/master/README.md)
setup.

During the zero-downtime upgrade, Gerrit end-users will not experience any
outage or service disruption and will be able to perform any read/write Gerrit
operation seamlessly.

The zero-downtime upgrade process for high-availability or multi-site setups
consists of the following steps ([demo](https://youtu.be/vK5qsb0W7q4)):

1. Have Gerrit servers running v3.11 in high-availability or multi-site
   configuration, healthy and able to handle the incoming traffic properly.
2. Set one of the Gerrit servers to unhealthy.
3. Shutdown the Gerrit server, update gerrit.war, plugins and libs to v3.12.x and start Gerrit again.
4. Verify that the Gerrit server is working properly (e.g. run automated smoke
   tests) and then make it healthy again.
5. Ensure the Gerrit server is fully caught up with the events that happened while
   it was down before directing traffic to it.
6. Repeat steps 2 to 5 for each of the remaining Gerrit servers.

### Downgrade

Downgrade to Gerrit v3.11 release is possible, but requires the following
manual steps:

1. Shutdown all migrated Gerrit servers
2. Update the gerrit.war and plugins to the previous v3.11 version
3. Init Gerrit

  ```sh
    java -jar gerrit.war init -d site_path --batch
  ```

### Native packaging

The GPG keys for GerritForge's distribution site have changed and need to be reimported
before the upgrade.

- On Debian / Ubuntu):
  `apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 55787ed781304950`

- on AlmaLinux / RedHat / Fedora:
  `rpm --import 'https://keyserver.ubuntu.com/pks/lookup?op=get&search=0x72adb205736d7147da56e8c955787ed781304950’`

The Docker-based distributions have been updated:

- AlmaLinux bumped to 9.5

- Ubuntu bumped to Eclipse Temurin 21.0.6_7 (24.04.1 LTS)

## Security Fixes

* [Change 435337](https://gerrit-review.googlesource.com/c/gerrit/+/435337)
  REST API responses are now rendered in the browser rather than downloaded, with XSS protection
  and blocking the use in i-frame.

### Known issues

* [Issue 454695136](https://issues.gerritcodereview.com/issues/454695136)
  Upgrade to new H2 v2 storage backend for persistent caches can cause corrupt
  cache files upon forced JVM shutdown.

The new H2 library brings multi-threaded operations, but also [one critical
issue](https://github.com/h2database/h2database/issues/4083), reported on cache
files corruptions upon Gerrit ungracefully shutdowns.

> **NOTE**: The `gerrit.sh stop` command performs a forced shutdown if the JVM
> does not exit within the shutdown timeout.

Whilst the problem is investigated, you may consider using alternative persistent cache backends like:
- [cache-chroniclemap](https://gerrit.googlesource.com/modules/cache-chroniclemap/)
- [cache-postgres](https://gerrit.googlesource.com/modules/cache-postgres) -
  **NOTE: This is not actively maintained, consider further testing before rolling out**

* [Issue 309098227](https://issues.gerritcodereview.com/issues/309098227)
  [Change 360646](https://gerrit-review.googlesource.com/360646):
The introduction of a per-request ref cache for better performance may break
the repository consistency

  The addition of a new `core.usePerRequestRefCache` setting, true by
  default, introduced a per request (currently per request thread) ref
  cache, helping reduce the overhead of checking if the packed-refs file
  was outdated. However, in some scenarios, such as multi-site or
  concurrency between `git-receive-pack` and `git-gc`, it may lead to
  split-brain inconsistencies and, in the worst-case scenario, to the
  corruption of the underlying repository.

### Breaking Changes

* [Change 447781](https://gerrit-review.googlesource.com/c/gerrit/+/447781)
  Disabled loading and executing 'rules.pl' by default.

  Prolog rules have been deprecated since Gerrit 3.6; they are now officially disabled
  by default. Gerrit administrators are required to inform all the project owners
  and convert the Prolog rules to Submit Requirements.

  > **NOTE**: It is still possible to enable the Prolog rules processing again with
  > `rules.enable = true` in `gerrit.config`, bearing in mind that the option may not be
  > available anymore in future versions of Gerrit, therefore should be used only
  > as temporary workaround during the migration from Prolog to Submit Requirements.


* [Change 440743](https://gerrit-review.googlesource.com/c/gerrit/+/440743)
  Do not notify listeners when performing online reindexing.

  When performing online reindexing, the notification to listeners and consequent
  sending of the index-change messages in high-availability and multi-site scenarios
  was potentially causing unnecessary traffic and CPU utilisation during the
  schema index updates.

  > **NOTE**: If the reindexing is performed for refreshing outdated index records
  > the online reindexing commands would need to be executed against all the nodes
  > of the Gerrit cluster, as the missed listeners notifications would not trigger
  > the reindexing elsewhere.

* [Change 449321](https://gerrit-review.googlesource.com/c/gerrit/+/449321)
  [Change 448244](https://gerrit-review.googlesource.com/c/gerrit/+/448244)
  Set Verified label default function to NoBlock for new sites.

  Label functions are deprected and the submittability of changes needs to
  be encoded as Submit Requirements, therefore new Gerrit sites are encouraged
  to define their submittability rather than relying on the legacy label functions
  deprecated since Gerrit v3.6.

  > **NOTE**: Existing sites would not be impacted, unless they were relying on the
  > default label function; however, Gerrit project owners are invited to remove the
  > use of label functions and use Submit Requirements instead.

* [Issue 390443239](https://issues.gerritcodereview.com/issues/390443239)
  Swap project-created/ref-updated in stream events upon project creation

  Gerrit always produced the project-created/ref-updated in the wrong order,
  generating the ref-update of inexistent projects just created. The order is
  now rectified; however, existing stream events consumers may rely on the
  previous incorrect ordering and potentially break.


* [Change 457802](https://gerrit-review.googlesource.com/c/gerrit/+/457802):
  Users with the `Administrate Server` can see all changes, branches and tags, including
  private changes and `refs/meta/config`.

  Administrators own the Gerrit service and are responsible for investigating
  issues; allowing access to everything simplifies troubleshooting, avoiding
  them to first assign permissions to themselves, investigate the issue and then
  remember to undo the permission changes.

  Also note that the `skip-visibility` option when querying changes is deprecated
  and effectively ignored. It will be removed in the next version of Gerrit.

  > **NOTE**: With this change, Gerrit would no longer allow to separate the
  > roles of security administrator and service management, therefore it
  > is highly recommended to carefully review all the users and groups with the
  > `Administrate Server`.

* [Change 435338](https://gerrit-review.googlesource.com/c/gerrit/+/435338):
  Patchsets are now downloaded as plain-text patch files using the ?raw parameter and
  not base64 or ziped.

* [Change 465369](https://gerrit-review.googlesource.com/c/gerrit/+/465369):
  Robot comments are disabled by default. Support for robot comments will be removed with the
  next release. Checks should be used instead.

* [Change 457007](https://gerrit-review.googlesource.com/c/gerrit/+/457007):
  The update to Lucene 10.1.0 removes support for the complement search operator `~`
  which was removed for performance reasons in
  [Lucene commit 22bbc603b4](https://github.com/apache/lucene/commit/22bbc603b40eb5accca005acb15f603384469e17).

### New Features

* [Change 451223](https://gerrit-review.googlesource.com/c/gerrit/+/451223):
  Added a new MigrateLabelFunctions site program for helping with the migration from
  label functions to Submit Requirements.

* [Change 472521](https://gerrit-review.googlesource.com/c/gerrit/+/472521):
  Render markdown in check run description.

* [Change 442981](https://gerrit-review.googlesource.com/c/gerrit/+/442981):
  Allow restricting users from deleting their own accounts.

  Introduce `accounts.enableDelete` configuration for disabling the ability for users
  to remove themselves from the Gerrit Web-UI.

* [Change 445801](https://gerrit-review.googlesource.com/c/gerrit/+/445801):
  Introduce `is:POSITIVE` and `is:NEGATIVE` as predicates for copyCondition on labels,
  allowing generic matching of any positive or negative reviews.

* [Change 447745](https://gerrit-review.googlesource.com/c/gerrit/+/447745)
  [Change 459463](https://gerrit-review.googlesource.com/c/gerrit/+/459463)
  [Change 447749](https://gerrit-review.googlesource.com/c/gerrit/+/447749)
  [Change 447748](https://gerrit-review.googlesource.com/c/gerrit/+/447748)
  [Change 447746](https://gerrit-review.googlesource.com/c/gerrit/+/447746)
  Assign TRACE_ID for every request and include in all SSH and HTTP interactions.

  Allow to follow the TRACE_ID across all interactions and logs, including
  the sshd_log and httpd_log entries.

* [Change 444441](https://gerrit-review.googlesource.com/c/gerrit/+/444441)
  Add `changeis` predicate as Copy-Condition expressions, with any predicate supported by
  `is:{predicate}`

* [Change 444962](https://gerrit-review.googlesource.com/c/gerrit/+/444962)
  [Change 457801](https://gerrit-review.googlesource.com/c/gerrit/+/457801):
  Add configuration for case-insensitive email matching in account resolution and API.

  Enable case-insensitive matching of the name part of e-mails on a per-domain basis,
  as configured in `accounts.caseInsensitiveLocalPart`.

* [Change 442021](https://gerrit-review.googlesource.com/c/gerrit/+/442021):
  Add `success_count` and `error_count` metrics for ssh requests.

* [Change 447841](https://gerrit-review.googlesource.com/c/gerrit/+/447841):
  Disallow addition of new rules.pl files in projects

  Adding a new `rules.allowNewRules = false` the Gerrit admin can reject
  the addition of new `rules.pl` files into the projects.

* [Change 456684](https://gerrit-review.googlesource.com/c/gerrit/+/456684)
  [Change 456685](https://gerrit-review.googlesource.com/c/gerrit/+/456685):
  Added draft comments cleanup REST-API and SSH command.

* [Change 456182](https://gerrit-review.googlesource.com/c/gerrit/+/456182):
  Added draftsCleanup background job and automatic scheduled configuration.

* [Change 447629](https://gerrit-review.googlesource.com/c/gerrit/+/447629):
  Added support for adding the Project Owners group as a reviewer

* [Change 445362](https://gerrit-review.googlesource.com/c/gerrit/+/445362):
  Added support for commit validators to return a status + metadata in addition to messages

* [Issue 317340200](https://issues.gerritcodereview.com/issues/317340200):
  Added support for creating a branch on an empty commit.

  Similar to creating a project with an empty commit, allow to create a branch
  not having any initial commit.

* [Change 439226](https://gerrit-review.googlesource.com/c/gerrit/+/439226):
  The new configuration style, where index name is explicitly provided as
  subsection name.

* [Change 447221](https://gerrit-review.googlesource.com/c/gerrit/+/447221):
  Store/provide merge conflict information for revisions created by Gerrit

  For revisions that are created by Gerrit, we know whether conflicts are
  present and which commits were used as 'ours' and 'theirs' during the
  Git merge that created the conflicts. For those revisions we can store
  this information in NoteDb and make it available to callers in
  RevisionInfo.

* [Change 446721](https://gerrit-review.googlesource.com/c/gerrit/+/446721):
  Provide index metric for accounts/changes/groups/projects

  Introduce four new Gauge metrics to track the number of documents
  in the respective search indexes:

  - indexes/accounts
  - indexes/changes
  - indexes/groups
  - indexes/projects

* [Change 447747](https://gerrit-review.googlesource.com/c/gerrit/+/447747):
  Include SSH session in the `error_log` entries

  The inclusion of the SSH session in the `error_log` allows to look for the errors
  associated with a specific session and trace, making it easier to troubleshoot
  problems.

* [Change 457722](https://gerrit-review.googlesource.com/c/gerrit/+/457722):
  Allow SubmitRequirement atoms to return an explanation

* [Change 447776](https://gerrit-review.googlesource.com/c/gerrit/+/447776):
  Make "message:" predicate for SR consistent with search

### Performance improvements

* [Change 442022](https://gerrit-review.googlesource.com/c/gerrit/+/442022):
  Faster replica startup when group reindexing enabled by parallelizing reindexing of groups

* [Change 448182](https://gerrit-review.googlesource.com/c/gerrit/+/448182):
  H2Cache BloomFilter will no longer degrade forever as it is rebuilt automatically after pruning
  if >= 25% invalidated

* [Change 447141](https://gerrit-review.googlesource.com/c/gerrit/+/447141):
  Reduce bulk action query result payload by not getting already available SUBMIT_REQUIREMENTS data

* [Change 447344](https://gerrit-review.googlesource.com/c/gerrit/+/447344):
  The List Labels endpoint now supports filtering by voteable labels.

* [Issue 390453038](https://issues.gerritcodereview.com/issues/390453038):
  Configure the number of open changes' refs advertised on push to a repository for reducing CPU
  utilization and latency.

* [Change 449582](https://gerrit-review.googlesource.com/c/gerrit/+/449582):
  Fix the reference counting for a correct release of repositories from the JGit in-memory
  repository cache.

  Previously the repositories were never released in the JGit in-memory cache, causing the overload
  of the JVM heap and consequent degradation of the performance due to the high CPU utilization
  caused by the continuous JVM GC.

* [Change 448181](https://gerrit-review.googlesource.com/c/gerrit/+/448181):
  With H2 v2 caches are multi-threaded therefore can be set operational concurrently with the
  building of bloomFilters

### Bug fixes

* [Change 473702](https://gerrit-review.googlesource.com/c/gerrit/+/473702):
  Prevent Duplicate Replies When Applying Fix.

  Resolves an issue where applying a fix to a comment unexpectedly created two draft replies instead
  of one, which was leading to two identical comments being published.

* [Change 469725](https://gerrit-review.googlesource.com/c/gerrit/+/469725):
  Fix incorrect `cherryPickOf` value when using the REST API to cherry-pick a non-current patchset.

* [Change 453981](https://gerrit-review.googlesource.com/c/gerrit/+/453981):
  gc_log is no longer overwritten when rotated.

* [Change 449582](https://gerrit-review.googlesource.com/c/gerrit/+/449582):
  Fix progress logging in MultiProgressMonitor, which had the unintended side effect to log the
  progress the receive commits operations

* [Change 464703](https://gerrit-review.googlesource.com/c/gerrit/+/464703):
  Cancel diff tasks failing due to timeout or interrupted preventing them from consuming resources
  unnecessarily

* [Change 442424](https://gerrit-review.googlesource.com/c/gerrit/+/442424):
  Respect project config and user preference for creating changes as work-in-progress by default for
  the Revert REST endpoint

* [Change 447640](https://gerrit-review.googlesource.com/c/gerrit/+/447640)
  [Change 447639](https://gerrit-review.googlesource.com/c/gerrit/+/447639):
  Reviewer suggestion for empty query: Fallback to project owners and reviewers of recent changes.

* [Issue 401141848](https://issues.gerritcodereview.com/issues/401141848):
  Fix ref existance check when creating new refs

  Gerrit v3.6 introduced a [new check](https://gerrit-review.googlesource.com/c/gerrit/+/287790)
  for verifying the existance of refs before crating new refs and avoiding misleading
  `LOCK_FAILURE` errors. The check was implemented using a `Repository.resolve()`
  API which would expand the ref name as it was a logical name resolution
  causing the inability to push some refs, like tags that use the
  _git describe_ in their names. The issue is fixed by using
  a proper refs finding and brings back the full refs creation functionality.

## Frontend changes

* [Change 473723](https://gerrit-review.googlesource.com/c/gerrit/+/473723):
  Prioritize and display all reviewers with votes or attention.

* [Change 473722](https://gerrit-review.googlesource.com/c/gerrit/+/473722):
  Fix header layout for very long subjects.

  The reviewers list UI component was hiding a reviewer who had voted (e.g., `+2`) if they were
  without attention and there was another 6 reviewers with attention. Now all reviewers who have
  cast a vote or are in the attention set are displayed.

* [Change 473701](https://gerrit-review.googlesource.com/c/gerrit/+/473701)
  Fixed the display of `removeLabel` permission in access section UI.

* [Change 471321](https://gerrit-review.googlesource.com/c/gerrit/+/471321):
  Enable keyboard shortcut for "Reset To" command in the download dialog.

  The initial implementation was limited to 5 shortcuts, but with the current default configuration,
  there are 6 commands (`Branch`, `Checkout`, `Cherry Pick`, `Format Patch`, `Pull`, `Reset To`).
  This update ensures that all commands, including `Reset To` have a keyboard shortcut.

* [Change 449581](https://gerrit-review.googlesource.com/c/gerrit/+/449581)
  Add HTTP request header to distinguish plugins from core.

  A new HTTP header `X-Gerrit-Request-Origin` added to the requests coming
  from the Gerrit Web-UI helps identify whether an API is invoked from `core-ui`
  or `plugin:<plugin-name>` for requests originated from plugins.

* [Change 464661](https://gerrit-review.googlesource.com/c/gerrit/+/464661):
  Allow opening edit preference in editor view.

* [Change 435399](https://gerrit-review.googlesource.com/c/gerrit/+/435399):
  Default patchset patch file download in the UI to plain-text patch files.

* [Change 443524](https://gerrit-review.googlesource.com/c/gerrit/+/443524):
  UiFeature__push_notifications experiment is now final and the feature flag is removed, making
  the browser notifications always enabled for all Gerrit sites.

* [Change 447628](https://gerrit-review.googlesource.com/c/gerrit/+/447628):
  Improved error message when trying to add a non-internal group as a reviewer

* [Change 460961](https://gerrit-review.googlesource.com/c/gerrit/+/460961):
  Send revert notifications from user that created the revert rather than the
  user that has set the change as ready.

* [Change 458461](https://gerrit-review.googlesource.com/c/gerrit/+/458461):
  The UI tooltop for submit requirement atoms will now show explanations if implemented by the
  underlying predicate

## Other Changes

* [Change 437803](https://gerrit-review.googlesource.com/c/gerrit/+/437803):
  Script providing extended git gc functionality

* [Change 438123](https://gerrit-review.googlesource.com/c/gerrit/+/438123):
  Add python-based CLI to maintain Gerrit sites

## Documentation changes

* [Change 447161](https://gerrit-review.googlesource.com/c/gerrit/+/447161):
  Clarify the documentation of `sshd.waitTimeout`

* [Change 451181](https://gerrit-review.googlesource.com/c/gerrit/+/451181):
  Document footer frontend endpoint decorators

* [Change 444481](https://gerrit-review.googlesource.com/c/gerrit/+/444481):
  Document the use of Gerrit-CI by the contributors and maintainers

* [Issue 381372612](https://issues.gerritcodereview.com/issues/381372612):
  Update the config-gerrit documentation mentioning a caveat of using `listProjectsFromIndex`
  setting

## Plugin changes

* [Change 441561](https://gerrit-review.googlesource.com/c/gerrit/+/441561)
  Introduce a new `CachesApi` endpoint for accessing and flushing caches from plugins.

* [Change 452183](https://gerrit-review.googlesource.com/c/gerrit/+/452183)
  [Change 457362](https://gerrit-review.googlesource.com/c/gerrit/+/457362):
  Introduce Repository leak detection when using AbstractDaemonTest, which can be disabled using
  `@NoGitRepositoryCheckIfClosed`

* [Change 447001](https://gerrit-review.googlesource.com/c/gerrit/+/447001):
  Add publish-edit event type for plugins to use.

* [Change 445142](https://gerrit-review.googlesource.com/c/gerrit/+/445142)
  [Change 445601](https://gerrit-review.googlesource.com/c/gerrit/+/445601):
  Added an extension point that allows to get to know about commit validation options

* [Change 457542](https://gerrit-review.googlesource.com/c/gerrit/+/457542):
  Added extension point that allows listening to operations retries

* [Change 455641](https://gerrit-review.googlesource.com/c/gerrit/+/455641):
  Updated ExternalIncludedIn extension point to allow plugins to use change information to obtain
  included-ins

* [Change 444804](https://gerrit-review.googlesource.com/c/gerrit/+/444804)
  [Change 442742](https://gerrit-review.googlesource.com/c/gerrit/+/442742):
   Mark setup_gjf.sh and run_gjf.sh for removal and replace them with one script gjf.sh.

* [Change 445202](https://gerrit-review.googlesource.com/c/gerrit/+/445202):
  Allow custom uploaderin operands for CopyCondition, having the format of
  `uploaderin:<operand>_<pluginName>`

## JGit Changes

* [Change 469321](https://gerrit-review.googlesource.com/469321):
  Update jgit from stable-6.10 (e328d203f) to servlet-4 branch (7a46fa6f8)
  which follows the jgit master branch with servlet-api downported to 4.0.4.

  ```shell
  git log --no-merges --oneline e328d203f..7a46fa6f8
  ```

  Notable changes are:
  - c2a8e0026 midx: reader for the multipack index
  - 4a5dfce0d SystemReader: Add support for XDG_CACHE_HOME
  - e2ddcc969 TreeRevFilter: enable Bloom Filter usage with ChangedPathTreeFilter
  - 52dc9fdd0 BlameGenerator: Use cache only for candidates modifying the path
  - ac5146ffb FileReftableStack: use FileSnapshot to detect modification
  - 1ff9c2a1c FileReftableDatabase: consider ref updates by another process
  - 68f454af4 DescribeCommand: Add exclusion matches using setExclude()
  - 8720b352a Insert the Change-Id at the end of the footer block
  - 70a3131d6 Update Change-Id insertion logic to insert after footers
  - bec51e7d7 pgm.MultiPackIndex: CLI command to write/print the multipack index
  - 871c5e177 BlameGenerator: cache and reuse blame results
  - 2d8777536 Downgrade from servlet-api 6.1.0 to 4.0.4
  - c625d67f8 URIish: fix stack overflow in regex matching
  - e9f43b6c1 midx.MultiPackIndexPrettyPrinter: pretty printer to debug multi pack index
  - 072e93fde midx.MultiPackIndexWriter: a writer for the multipack index format
  - 4c4bef885 DirCacheCheckout.preScanOneTree: consider mode bits
  - f41253804 Merge: improve handling of case-variants
  - ff3a15049 Improve configuration of trusting file attributes in FileSnapshot
  - a86e2a7d7 Config: add getters for primitive types without default value
  - 772ee0e5f Log pruned packfiles as debug and not warn logs
  - 32b9a9523 Submodules: Update submodule with deleted worktree
  - 7b8ddc2ce RefDatabase#getReflogReader(String): use #exactRef to resolve refName
  - fda44a444 Add RefDatabase#getReflogReader methods
  - e9094fffd RevertCommand: use only first line in revert commit message
  - df7810957 Submodules: use relative paths for worktree and gitdir
  - bd57a19fa TreeWalk: Make a null check before dereferencing the config variable.
  - 6fa28d767 Add pack-refs command to the CLI
  - 307ef6b4b GitTimeParser: A date parser using the java.time API
  - ba905906c Change default similarity score to 50(%) to match git's default
  - b2accb0e9 GPG: use bouncycastle PGP secret key parsing out of the box
  - d1a14b8ff SSH signing: implement a SignatureVerifier
  - c9958e9b7 SSH signing: implement a Signer
  - 4902b2baf Add `numberOfPackFilesAfterBitmap` to RepoStatistics
  - 1519c1479 Align request policies with CGit
  - 0155f8bf6 RevolveMerger: honor ignoreConflicts also for binary files
  - 1332b5156 Record failing paths in recursive merge.
  - 0fd76114e Replace custom encoder Constants#encodeASCII by JDK implementation
  - e5d289899 Replace custom encoder `Constants#encode` by JDK implementation
  - 9fec73970 Do not set headers if response is already committed
  - a78e6eaef Signing: refactor interfaces
  - 81199f02f Lib: Fix ssh value for gpg.format throwing an IllegalArgumentException
  - f9beeb3b3 Add worktrees read support
  - 47fd412af RepoProject: read the 'dest-branch' attribute of a project
  - 48465f840 RepoCommand: Copy manifest upstream into .gitmodules ref field
  - 1dd6324d4 RepoProject: read the "upstream" attribute of a project


## Other dependency changes

* Update auto-value to 1.11.0

* Update guava to 33.4.0

* Update reload4j to 1.2.26

* Update org.tukaani:xz to 1.10

* Update dropwizard.metrics to 4.2.30

* Update mina-sshd to 2.15.0

* Update mina-core to 2.0.27

* Update commons-io to 2.18.0

* Update autovalue to 1.11.0

* Update truth to 1.4.4

* Update Lucene to 10.1.0

* Update h2 to 2.3.232

* Update gitiles to 1.6.0

* Update bouncycastle to 1.80

* Remove net.i2p.crypto:eddsa

* Update errorprone to 2.36.0

* Update flogger to 0.8

* Update gson to 2.12.1

* Update jgit to f22643b39

## Bugfix releases

### 3.12.4

* Bug Fixes

  * [Issue 461836624](https://issues.gerritcodereview.com/issues/461836624):
  Deregister queue metrics upon unload, allowing plugins to enable metrics on executors.

    Previously, the `WorkQueue` did not deregister metrics upon shutdown.
    This prevented plugins from effectively creating queues with associated
    metrics, often resulting in reloading or restarting failures due to
    duplicated metric names.

  * [Change 524669](https://gerrit-review.googlesource.com/524669):
  `migrate-externalids-to-insensitive` now logs all duplicates in dry-run mode.

    The `migrate-externalids-to-insensitive` command no longer stops at
    the first duplicate occurrence; instead, it logs all duplicate IDs,
    allowing admins to identify all usernames that conflict in their case
    in one go.

  * [Issue 466122136](https://issues.gerritcodereview.com/issues/466122136):
  Fix the username in the URL generated by the `download-commands` plugin
  when `auth.gitBasicAuthPolicy` is `LDAP`.

* UI Fixes

  * [Change 542241](https://gerrit-review.googlesource.com/542241):
    Fixed `Delete vote` button not checking removable_labels and therefore
    not respecting the ACLs for displaying it.

* Enhancements

  * [Issue 454830631](https://issues.gerritcodereview.com/issues/454830631):
  Enable the generation and persistence of Lucene stream logging

    Introduced the ability for Gerrit admins to troubleshoot indexing
    transactionality or persistence issues by enabling
    `index.<name>.persistInfoStream` in `gerrit.config` and generating
    Lucene stream persistence logging.

  * [Change 526341](https://gerrit-review.googlesource.com/526341):
  Add `--preserve-migration-mode` option to `migrate-externalids-to-insensitive` command

    This new flag for `migrate-externalids-to-insensitive` skips automatically setting
    `auth.userNameCaseInsensitiveMigrationMode` to `false` after migration, which can
    be useful in multi-primary environments.

* JGit changes

  * [Issue 470114241](https://issues.gerritcodereview.com/issues/470114241):
    Bump JGit to bb309748c

    You can retrieve the full list of changes with:
    ```
    git log --oneline --no-merges 010858e24..bb309748c
    ```

    Changes included are:
    - 0f71bbab3 DfsPackFileMidx: make the class public
    - e3ec1e57c `[ssh]` Fix order of keys in pubkey auth if an agent is used
    - 008955d57 Update bytebuddy to 1.17.8
    - 87337f302 Update jetty to 12.1.2
    - ed0f86af0 DfsPackCompactor: Move #autoAdd to the tests (its only caller)
    - c29026355 DfsPackFileMidx: add #getAllCoveredPacks() method
    - fab22a4a2 DfsGarbageCollector: handle pack lists with multipack indexes
    - 89823f0f9 DfsPackFileMidx: Return bitmap from any underlying pack
    - 3ec94f2d3 midx: caller chooses the order of packs in the midx
    - dac4c985a DfsObjDatabase: make #setUseMultipackIndex public
    - 6ae972963 MidxPackFilterTest: Remove unused import
    - bbce03704 DfsObjDatabase: move pack mangling to helper MidxPackFilter
    - 2ba761403 Document how to test a release staged in Maven Central Portal
    - 5f38c0af1 DfsMidxWriter: helper class to create a pack with an midx
    - 5b3757ed5 DfsObjDatabase: make useMultipackIndex getter/setter protected
    - acea22570 Update Maven plugins
    - ee5bfa014 DfsObjDatabase: introduce multipack index
    - 18d959f4f Add jgit-4.38 target platform for Eclipse 2025-12
    - 8e9d7ae9b Update jna to 5.18.1
    - 4d5cc0136 Migrate deployment to Maven Central to use Central Portal API
    - 317efecb1 DfsPackFileMidx: getters for the midx covered packs and base
    - 0e2176ecf DfsPackFileMidx: support a chain of multi-pack indexes
    - b2160eb4f DfsPackFileMidx: A packfile using the multipack index
    - 45eb742b6 Checkout: don't fail if no commitish was given
    - ca22260c6 Remove unnecessary else clause
    - dda14deb0 Remove redundant null check
    - cc452d9b1 Remove unused API error filters
    - d1ecb6cac Fix discouraged access warnings
    - 8aa9aa8f0 Fix boxing warnings
    - b70bc5a7f Suppress some boxing warnings
    - d2a6d1063 Suppress some unboxing warnings
    - 72f72fff2 Remove unnecessary semicolon
    - 0795b926b Silence API error for constant CoreConfig.DEFAULT_MULTIPACK_INDEX_ENABLE
    - e1b3e5d63 Update org.mockito:mockito-core to 5.20.0
    - 2bba95d78 Update jetty to 12.1.1
    - 07dc33fb0 Update bouncycastle to 1.82
    - 1ac94c881 Update org.assertj:assertj-core to 3.27.6
    - 665089f0b Update org.apache.commons:commons-lang3 to 3.19.0
    - 99377fc6e Update jna to 5.18.0
    - de78e4d05 Update com.google.code.gson:gson to 2.13.2
    - fc18af059 ConfigConstants: Add constant for multipack index
    - ebc179fa1 Support unshallow request in Boundary/TopoSortGenerators
    - a5a1c87e2 Make UNSHALLOW a globally available static RevFlag
    - 1f4a13450 DfsPackDescription: make covered packs non-null
    - d5b6962cf Disable BOUNDARY and TOPO sort for unshallow fetches
    - 20d9a97cd BasePackWriterTest: Increase test coverage for unshallow fetches
    - 7739cddc4 IndexDiffWithSymlinkTest: Java 20+ stores NFC, not NFD
    - 9a748158b DfsPackDescription: Add fields for multipack index
    - 79483239f BasePackWriterTest: Improve assertion of unexpected items in pack
    - ba38b0c1a BasePackWriterTest: use assertThrows instead of @Test(expected=...)
    - 207f3046c [releng] Bump japicmp base version to 7.4.0.202509020913-r
    - 028565abb BasePackWriterTest: Fix message on pack index content assertion
    - 69b4bb7b5 Add Jenkinsfile to trigger Bazel CI for servlet-4 branch
    - 0e463e66c BasePackWriterTest: Use @expected instead of catching exceptions
    - 15d887625 BasePackWriterTest: Prefer use of Java native sort vs. Collections
    - 953d624b8 Provide specific test for HPE NonStop OSS file system long file names.
    - c7975b456 Prepare 7.5.0-SNAPSHOT builds
    - 797e22b13 Prepare 7.4.1-SNAPSHOT builds
    - 3f5de671a Fix NPE when calling GC.prune(Set<ObjectId>)
    - 78b1ccb45 (tag: v7.4.0.202509020913-r) JGit v7.4.0.202509020913-r
    - 3caa6d233 MultiPackIndex.resolve: handle correctly last object
    - ba209b9ae MultiPackIndexWriter: report also object count and ordered packs
    - 22bbd3db2 MultiPackIndex: add getObjectCount() method
    - 09ad00d21 MultiPackIndex: add findPosition method
    - a9bb14ae4 MultipackIndex.PackOffset: add public static constructor
    - 9d48b26f5 RevWalk: use SystemReader instead of System.getProperty()
    - acd1eff8b PendingGenerator: drop only buffers loaded in the generator
    - 7f9eeb969 Prepare 7.4.0-SNAPSHOT builds
    - 3ce0a6bc8 (tag: v7.4.0.202508261455-rc1) JGit v7.4.0.202508261455-rc1
    - 0ba68dfb0 Update apache sshd to 2.16.0
    - 8fd4cf3de Do not include 3rd party dependencies in features
    - e109bad94 Ensure pack files are closed after git.close()
    - 38aaf90f9 Prepare 7.4.0-SNAPSHOT builds
    - cad966d95 (tag: v7.4.0.202508191000-m3) JGit v7.4.0.202508191000-m3
    - 7e2935241 Update mockito to 5.19.0
    - bcbb2d6ce Update jetty to 12.1.0
    - 9b0bbd744 Update org.assertj:assertj-core to 3.27.4
    - deefd465a Update bytebuddy to 1.17.7
    - 610d7e191 util.Iterators: suppress warning about object arrays
    - 93e87dfc7 util.Iterators: private constructor for utility class
    - 901b651ec pgm: new command for the object size index
    - 2b64b5c6f WindowCursor: honor pack.useObjectSizeIndex
    - 6ebd2f5d7 Prevent CommitGraphWriter.write() from closing its stream
    - 1c0df9426 Make CancellableDigestOutputStream extend FilterOutputStream
    - 5155683dc Shortcut PackWriter reuse selection when possible
    - 0a32120fa Update org.apache.commons:commons-compress to 1.28.0
    - a762badfc SmartHttpFetchConnection: suppress errors on close()
    - 01123ee70 Mark Git(Repository repo, boolean closeRepo) public
    - ee304e465 Use volatiles for bitmap and revIndex in Pack
    - 37d1a65f0 Fix performance regression in Pack.idx()
    - 3a89c4e49 Don't use Yoda style conditions to improve readability
    - 0efc9c367 Use LocalObjectToPack representation more
    - d9aba160b Use representation from LocalObjectToPack if possible
    - 6c8d6e299 Avoid conditional in LocalObjectRepresentation.wasDeltaAttempted
    - d9de5e619 Prepare 7.4.0-SNAPSHOT builds
    - ee0b62d24 Update commons-lang3 to 3.18.0
    - 0962202b2 Update commons-io to 2.20.0
    - 16554a89d Update commons-codec to 1.19.0
    - fb6b24142 (tag: v7.4.0.202507290921-m2) JGit v7.4.0.202507290921-m2
    - e02e00109 Add 4.37 target platform for Eclipse IDE 2025-09
    - ca6d673d5 Use chunked encoding when uploading LFS objects
    - 154032c2b Add Bundle-SCM header to OSGi manifests
    - c86cdcb96 WindowCursor: Use the object size index when possible
    - a673f022a GC: Write object size index if config says so
    - b0e06f3b0 MergeToolTest: update expected error from the tool
    - 160b81c0b Add dash license check for 3rd party dependencies
    - d9ac2f31e ObjectDirectoryPackParser: Write object-size index with the pack
    - 8929300aa PackInserter: write object-size index with the pack
    - 427af1262 Pack: getter for the indexed object size (when available)
    - 8ab3e5324 Prepare 5.13.5-SNAPSHOT builds
    - 85c14b4da (tag: v5.13.4.202507202350-r) JGit v5.13.4.202507202350-r
    - 896d07370 AmazonS3: Do not accept DOCTYPE and entities
    - 8d30b5a75 ManifestParser: Do not accept DOCTYPE and entities
    - 518cc54f8 AdvertisedRequestValidator: fix WantNotValidException caused by race
    - 0d835f824 Prepare 5.13.4-SNAPSHOT builds
    - 36fef211d Fix packaging build
    - 918fdd774 [releng] Fix maven builds on JVM 21 and with newer git on MacOS

### 3.12.3

* Bug Fixes

  * [Change 495501](https://gerrit-review.googlesource.com/495501):
    `sequence set` SSH command now enforces strictly increasing sequence values.

    Attempts to set a sequence (for `changes`, `accounts`, or `groups`) to a value lower than its
    current value are now rejected immediately.

  * [Issue 439435039](https://issues.gerritcodereview.com/issues/439435039):
    Check for account existence with username scheme for `HTTP` and `HTTP_LDAP` only.

    Previously, when LDAP authentication was enabled, user lookups were incorrectly performed
    using the `username` external ID scheme, which could lead to failed logins.
    This change restricts username-based lookups to `HTTP` and `HTTP_LDAP` authentication
    protocols only, ensuring `LDAP` uses the correct `gerrit` scheme.

  * [Issue 439859126](https://issues.gerritcodereview.com/issues/439859126):
    Return `HTTP 401` for any incoming authentication request with a password longer than `71` chars

    Fixed password validation to explicitly fail when a password is longer than 71 characters,
    matching the Bcrypt limitation. This prevents internal errors and ensures clients receive a
    proper `HTTP 401 (Unauthorized)` response instead of an internal exception.

  * [Issue 444049514](https://issues.gerritcodereview.com/issues/444049514):
    Prevent blocking HTTP calls to wait indefinitely.

    Fixed an issue where, under heavy concurrent Git/HTTP load, some worker threads could remain
    stuck indefinitely due to unbounded blocking in synchronous write callbacks.
    Blocking callbacks are now properly capped by the configured `httpd.idleTimeout`, ensuring
    idle or stalled Git/HTTP requests are terminated and threads are released as expected.

  * [Issue 397701289](https://issues.gerritcodereview.com/issues/397701289):
    Notify reviewers on change edit in UI.

    Restored reviewer notifications when a change is edited through the web UI. This makes
    notification behavior consistent with other change updates, ensuring reviewers are informed when
    an edit may require another review.

  * [Change 510442](https://gerrit-review.googlesource.com/510442):
    Allow WorkQueue to be used with the failsafe.dev library in the `high-availability`
    plugin to schedule retryable tasks.

  * [Issue 446941362](https://issues.gerritcodereview.com/issues/446941362):
    Fixed git-upload-pack errors on replicas by skipping unloadable changes.

    Fixed an issue where corrupted or unloadable changes could cause Internal Server Errors during
    `git-upload-pack` on replicas.

  * [Issue 456521736](https://issues.gerritcodereview.com/issues/456521736):
    Avoid _"change N missing from ChangeSet[][]"_ error when submitting a change with a stale index
    entry.

    Fixed an issue where submitting a change could fail if its index entry was out of sync with
    the underlying NoteDb data. Gerrit can now backfill missing change information directly from
    the repository when the index is stale, ensuring that valid changes can still be submitted
    without repeated retries.

    A new configuration option, `change.backfillMergeSuperSet`, controls this behavior.
    When enabled, Gerrit reloads change data from the repository instead of failing due to a stale
    index, making change submissions more reliable in setups that use asynchronous indexing or
    multiple primaries.

  * [Change 497281](https://gerrit-review.googlesource.com/497281):
    Fixed the name of the operations endpoint latency metric to ensure accurate per-endpoint
    performance tracking.

    Corrected the name of the operations endpoint latency metric, which was previously using the
    same name as the general `performance/operations` metric.

  * [Issue 440670678](https://issues.gerritcodereview.com/issues/440670678):
    Introduce listener hook for project-wide change index deletions.

    Previously, when all changes for a project were deleted from the index, no listener notifications
    were triggered. This prevented plugins such as `high-availability` and `multi-site` from
    detecting these deletions and cleaning up related state.

    A new listener hook, `onAllChangesDeletedForProject`, has been added and is now invoked whenever
    a project’s indexed changes are removed in bulk. This ensures that dependent plugins are
    notified consistently and can react reliably to project-wide deletions.

* Documentation Updates

  * [Change 500401](https://gerrit-review.googlesource.com/500401):
    Document the HTTP password limit of `71` chars.

  * [Change 520901](https://gerrit-review.googlesource.com/520901):
    Document the REST API Get Patch `parent` parameter.

  * [Change 515462](https://gerrit-review.googlesource.com/515462):
    Remove instructions to build with Java 17.

* UI Fixes

  * [Change 511981](https://gerrit-review.googlesource.com/511981):
    `gr-access-section`: Fix bug with deleting permissions in handleAddedPermissionRemoved.

    Resolved an issue where removing a permission (e.g., Delete Own Changes) could also
    unintentionally remove another permission (e.g., `Delete Changes`) and incorrectly display an
    `undo` option. The UI now correctly tracks and removes only the selected permission, and the
    undo button appears only for previously saved permissions.

  * [Change 515221](https://gerrit-review.googlesource.com/515221):
    Allow Change Owners to suggest edits in comments.

    Change owners can now propose suggested edits directly in comments, even if they are not the
    original authors of the change.

  * [Change 517961](https://gerrit-review.googlesource.com/517961):
    `gr-permission`: Fix deleting rule in `gr-rule-editor`.

    Resolved a UI issue where deleting a rule could affect the wrong entry due to DOM node reuse.

  * [Change 512922](https://gerrit-review.googlesource.com/512922):
    Fix rendering of multiple suggested edits when comments contain tabs.

    Previously, only the first suggested edit was shown when a comment contained multiple suggestions.
    Now, all suggestions are displayed correctly, allowing users to view and apply each one
    individually.

  * [Change 509501](https://gerrit-review.googlesource.com/509501):
    `gr-textarea`: Fix `getSelection()` on Safari.

    Resolved an issue in the text area component where pressing `Option + Right Arrow` on Safari
    did not move the cursor or update the text selection as expected.

  * [Change 509463](https://gerrit-review.googlesource.com/509463):
    Fix bug with `disabledMenuActions` in `gr-change-actions`.

    Fixed a UI issue where menu actions were not properly disabled when `disabledMenuActions` was
    set, allowing users to trigger actions multiple times while one was still running.

  * [Issue 445614699](https://issues.gerritcodereview.com/issues/445614699):
    Fix deleting text under Firefox when selecting all text.

    Resolved a compatibility issue in the text area component where deleting all selected text did
    not work correctly in Firefox.

  * [Issue 440874371](https://issues.gerritcodereview.com/issues/440874371):
    Avoid hacking the `GitRepositoryManager` on init, which broke the initialisation of a Gerrit
    site with `Zookeeper`.

    Resolved an issue that caused Gerrit site initialization to fail when using a global ref
    database such as `Zookeeper`.

* Enhancements

  * [Issue 440798012](https://issues.gerritcodereview.com/issues/440798012):
    Add scheduled reindexing of accounts.

    Add scheduled reindexing of accounts. Previously scheduling reindexing was possible only for
    `Changes`, `Projects` and `Groups`.

* Dependency Updates

  * [Issue 442989229](https://issues.gerritcodereview.com/issues/442989229):
    Update Jetty to `9.4.57.v20241219`.

    Please refer to the
    `jetty.project` [changelog](https://github.com/jetty/jetty.project/compare/jetty-9.4.53.v20231009...jetty-9.4.57.v20241219)
    for details.

* Plugin changes

  * `delete-project` updated to `b1a05c0c2ef2d5fe60f0c4c5863576707540dbbf`

    Notable changes are:
    * [Issue 440670678](https://issues.gerritcodereview.com/issues/440670678):
      Use centralized change index deletion when removing a project.

      Updated project deletion to use the higher-level `ChangeIndexer.deleteAllForProject()` API
      instead of calling low-level index operations directly. This ensures that all project changes
      are removed from the index in bulk and it triggers the appropriate deletion notifications.

      You can retrieve the full list of changes with:
    ```shell
    git log --no-merges --oneline 08035f1ef90258629346ab033af27c454a7fcc2d..b1a05c0c2ef2d5fe60f0c4c5863576707540dbbf
    ```

### 3.12.2

* Bug Fixes

  * [Issue 437141693](https://issues.gerritcodereview.com/issues/437141693):
    Fix an issue introduced in Gerrit 3.12.1 where plugins' persisted caches weren't persisted anymore.

  * [Issue 437005987](https://issues.gerritcodereview.com/issues/437005987):
    Prevent creation of tag via rest-api if project is in read only state.

  * [Change 498181](https://gerrit-review.googlesource.com/c/gerrit/+/498181)
    Fix Submit Requirements that used `ownerin:group_name` with Gerrit internal
    group names.
    Groups with external subgroups were unaffected.

  * [Issue 435230894](https://issues.gerritcodereview.com/issues/435230894)
    Fix instances where changes sequence ref is rewind

    Enforced strictly increasing ref sequence values to prevent rare stale-read
    issues on NFS.

* Frontend changes
  * [Issue 433273946](https://issues.gerritcodereview.com/issues/433273946)
    gr-edit-controls: Fix alignement issue with autocomplete on mobile

  * [Change 497461](https://gerrit-review.googlesource.com/c/gerrit/+/497461):
    Inline link on branches and tags on a repository's branch and tag lists
    now respect gerrit.primaryWeblinkName configuration.

  * [Change 464281](https://gerrit-review.googlesource.com/c/gerrit/+/464281):
    "Browse" link on a repository's General page now respect
    gerrit.primaryWeblinkName configuration.

* Enhancements
  * [Change 486062](https://gerrit-review.googlesource.com/c/gerrit/+/486062)
    Remove index-only entries after (re)index with `--reuse` option

    Added a post-reindex cleanup step for the --reuse option to remove index
    entries without corresponding NoteDb changes. Cleanup runs per project,
    starting as soon as indexing for that project completes.

  * [Change 486081](https://gerrit-review.googlesource.com/c/gerrit/+/486081)
    Enabled setNoLimit in the InternalQuery API, allowing the AllChangesIndexer to
    exponentially increase page size when scanning large result sets. This can
    significantly reduce the number of index queries (e.g., 200 pages down to 4
    for 100K results).

* Other dependency changes
  * [Change 477406](https://gerrit-review.googlesource.com/c/gerrit/+/477406)
    Set Gerrit typescript API to 3.12.0

* Documentation
  * [Change 494022](https://gerrit-review.googlesource.com/c/gerrit/+/494022)
    Update linux-quickstart.txt with a more up-to-date example of Gerrit version

### 3.12.1

* Known issues

  * [Issue 437141693](https://issues.gerritcodereview.com/issues/437141693):
  Plugins' persisted caches aren't persisted anymore, due to the removal of the lazy
  initialization of the H2Cache's bloomfilter.

    The introduction of the performance improvement in [Change 473682](https://gerrit-review.googlesource.com/c/gerrit/+/473682) has removed
    the lazy initialization of the H2Cache's bloomfilter which is needed for enabling
    the persistence of the cache keys. The consequence is that the plugins that were
    declaring a persistent cache would not be able to persist their cached values
    anymore.

* JGit changes
  * [Change 491146](https://gerrit-review.googlesource.com/c/gerrit/+/491146):
    Bump JGit to 010858e24

    This includes a fix for races that could occur when deleting refs and
    another actor tries to pack refs.

    You can retrieve the full list of changes with:
    ```
     git log --no-merges --oneline 7a46fa6...010858
    ```

    Notable changes are:

    * b943e49d2 Fix JGit version exposed in bazel module
    * a35be22e0 MODULE.bazel: Include version in the jgit module
    * c3f354edc Lock reftable auto-refresh to ensure consistency
    * 426a6c70c DfsObjDatabase.PackList: Remove PackListImpl subclass
    * 783b4a509 DfsObjDatabase.PackList: Remove dirty flag setters
    * 6f5e28454 DfsPackFile: Delete #getIndexedObjectSize for ObjectId
    * 7c7f7d32e MultiPackIndexLoader: Add NON-NLS annotation to message
    * 9fb0c4fca ChangedPathFilter: Suppress nls warnings in toString
    * e3c003cac JGitText.properties: Use {n} instead %s in messages
    * f52f450f9 DfsReader: Reuse index position when looking up object size
    * a0baaa03b DfsReader: Use new findPack instead of findPackWithObject
    * 1ffcbb98d DfsReader: return idx position when looking up object in packs
    * f6bfc81cf DfsReader: Handle correctly invalid object-size indexes
    * 3f3f3b5a6 Fix: Close the "preserved" PackDirectory
    * 1c7289509 Use the same ordering/locking in delete() as C git
    * 3e0eedc57 AmazonS3: Do not accept DOCTYPE and entities
    * 07d00f6df ManifestParser: Do not accept DOCTYPE and entities
    * 98494cd1a FS.getFileStoreAttributes: cancel failed task executed asynchronously
    * ca665a4f0 DfsReader/PackFile: Move represention to the packfile
    * 9b27a961f DfsPackFile: Remove unused getObjectCount method
    * c6fc36070 AmazonS3: Do not accept DOCTYPE and entities
    * dab4f52d4 ManifestParser: Do not accept DOCTYPE and entities
    * 4919c2b70 FileReftableStack: ensure new reftable files aren't missed on NFS
    * f96e5e3b4 Encapsulate layout of reftable stack in FileReftableStack
    * d0e7071b1 DfsInserter: Remove checkExisting setter and parameter
    * 32e0e27be PlotRefComparator: fix #timeof
    * 43d3bc6d6 PlotWalk: Replace call to deprecated method in PersonIdent
    * e74771cb9 midx: Fix license header from Google Inc. to LLC
    * 0595aa0f0 Remove option to enable bzlmod
    * b26ff8c5d MODULE.bazel: Move dependencies from WORKSPACE to bazel modules


* Bug Fixes

  * [Issue 430336832](https://issues.gerritcodereview.com/issues/430336832):
    Align delete refs to the rest of Gerrit

    The ChangeEditUtil.deleteRef() and StarredChangesUtilNoteDbImpl.deleteRef()
    failed to set the new object id in the RefUpdate, causing a situation where
    other parts of the code are expecting a non-null SHA1 and therefore causing
    potential NPEs.

  * [Change 486742](https://gerrit-review.googlesource.com/c/gerrit/+/486742):
    Fixed project list cache data race due to Caffeine issue

  * [Change 473701](https://gerrit-review.googlesource.com/c/gerrit/+/473701):
    Fixed removeLabel permission not being displayed in access section UI

  * [Issue 412679366](https://issues.gerritcodereview.com/issues/412679366):
    Fixed an issue with a comment's resolved flag not updating

    When PostReview.comments is set, they are supposed to replace the value of the
    draft with the same id (if one exists). The logic were replacing the message,
    but not the resolved bit. Leading to the update being lost.

  * [Change 482026](https://gerrit-review.googlesource.com/c/gerrit/+/482026):
    Fixed reindexing stale changes in projects with encoded characters

    Without this fix, any project with characters in its name that must be
    encoded would fail staleness checks with a "repository not found:
    Invalid name" message

  * [Change 473802](https://gerrit-review.googlesource.com/c/gerrit/+/473802):
    Fix wrong column sort in change list

  * [Change 478326](https://gerrit-review.googlesource.com/c/gerrit/+/478326):
    Fix paper-toggle-button for iOS

  * [Change 486743](https://gerrit-review.googlesource.com/c/gerrit/+/486743):
    Fix a special case for preview/apply fix

  * [Change 487821](https://gerrit-review.googlesource.com/c/gerrit/+/487821):
    Use ASM9 opcodes to avoid plugin Jar scan warning

  * [Change 473682](https://gerrit-review.googlesource.com/c/gerrit/+/473682):
    Do not wait for H2 bloomfilter building to respond to requests

* Enhancements

  * [Change 481621](https://gerrit-review.googlesource.com/c/gerrit/+/481621):
    Checks: Display hovercard for previous run attempts

  * [Change 481583](https://gerrit-review.googlesource.com/c/gerrit/+/481583):
    Add 'shift+h' keyboard shortcut to hide check code pointers in the diff view

  * [Change 474701](https://gerrit-review.googlesource.com/c/gerrit/+/474701):
    Prompt users before becoming the change uploader

  * [Change 462141](https://gerrit-review.googlesource.com/c/gerrit/+/462141):
    Improve error message when failing a submission for FAST_FORWARD_ONLY projects, avoiding also an NPE on the error_log

* Documentation Updates
  * [Issue 412679366](https://issues.gerritcodereview.com/issues/412679366):
    config-gerrit: Document change_notes cache

* Plugins
   * Update `codemirror-editor` to `6a33a4`

     You can retrieve the full list of changes with:
     ```
     git log --no-merges --format=oneline 5248349...6a33a4
     ```

      * ac9a00c Resize CodeMirror dynamically
      * 8f421dc Remove outline on textbox
      * 5b5c024 Display cursor position in the bottom
      * 815b880 Fix going to line
      * 0660e0b Use Postgresql, PLSQL and Cassandra from sql package
      * 78d9ef2 Allow jsx to be highlighted in .js
      * c7e40a7 Allow highlighting tsx files

  * Update `replication` to `b0e7aa63c`

    You can retrieve the full list of changes with:
    ```
    git log --oneline --no-merges --no-decorate ede3010e..b0e7aa63c
    ```

      * 83e15b0 Fix concurrent pushes to the same target URI
      * 5be3cc5 Make excludedRefsPattern() to return an empty list by default
      * f01716c Do not push deletes for refs configured to be skipped
      * 4161f94 Add a remote config to exclude replicating desired refs

## Frontend changes

  * [Change 476822](https://gerrit-review.googlesource.com/c/gerrit/+/476822):
    UI: Fix loading fonts with base url