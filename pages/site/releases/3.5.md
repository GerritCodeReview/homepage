---
title: "Gerrit 3.5.0 release"
permalink: 3.5.html
hide_sidebar: true
hide_navtoggle: true
toc: true
---

Download: **TBD**

Documentation: **TBD**

## Release highlights

### Case-insensitive usernames

Users can login with mixed case usernames without the risk to create
duplicate accounts.

The change affects the following external ids:
* `gerrit`   (LDAP)
* `username` (authentication REST and git endpoints)

For a new Gerrit setup, usernames are case insensitive by default, while for
existing installations the Gerrit admin can switch the functionality on/off
using the [`auth.userNameCaseInsensitive`](https://gerrit-documentation.storage.googleapis.com/Documentation/3.5.0/config-gerrit.html#auth.userNameCaseInsensitive)
setting in `gerrit.config`.

> **NOTE**: In the All-Users.git repository, the SHA-1 sum of the account
> is computed preserving the case of the external ID. See the full details
> in the [Gerrit config accounts documentation](https://gerrit-documentation.storage.googleapis.com/Documentation/3.5.0/config-accounts.html#external-ids). Existing accounts can be migrated to
> the new SHA-1 sum using the
> [ChangeExternalIdCaseSensitivity](https://gerrit-documentation.storage.googleapis.com/Documentation/3.5.0/pgm-ChangeExternalIdCaseSensitivity.html)
> migration tool.

### Request cancellation and execution deadlines

To limit the maximal execution time for requests, administrators can configure
server-side deadlines. More details are available in the
[Gerrit documentation](https://gerrit-documentation.storage.googleapis.com/Documentation/3.5.0/user-request-cancellation-and-deadlines.html
).

Any operation in Gerrit can now be subject to a configurable deadline, using
the [`deadline`](https://gerrit-documentation.storage.googleapis.com/Documentation/3.5.0/config-gerrit.html#deadline.id)
section in `gerrit.config`.

> **NOTE**: Deadlines are only supported for `REST`, `SSH` and `GIT_RECEIVE`
> requests, but not for `GIT_UPLOAD` requests.

Gerrit commands can define an execution deadline, so that the processing
triggered on the server would be able to end in a definite time, even in case
of network interruption of the connection with the client.

### Removal of external ids

Gerrit external ids, including the username, can now be removed using the
[SSH command](https://gerrit-documentation.storage.googleapis.com/Documentation/3.5.0/cmd-set-account.html)
or [REST API](https://gerrit-documentation.storage.googleapis.com/Documentation/3.5.0/rest-api-accounts.html#delete-account-external-ids).

> **NOTE**: Users that have the __Modify Account__ permission can delete
> external ids that belong to other accounts. External ids in the `username`
> scheme can only be deleted by users that have __Administrate Server__
> or both `Maintain Server` and `Modify Account`. See the
> [documentation](https://gerrit-documentation.storage.googleapis.com/Documentation/3.5.0/rest-api-accounts.html#delete-account-external-ids)
> for further details.

### Copy labels to new patch-sets

Gerrit can matches patch set approvals against the provided query
string and, if the query matches, the approval is copied from one patch set
to the next.

The copy label feature is controlled by the
[`label.Label-Name.copyCondition`](https://gerrit-documentation.storage.googleapis.com/Documentation/3.5.0/config-labels.html#label_copyCondition)
in `project.config`.

### Submit requirements

The change screen can now display the requirements that are needed for a change
to be merged.

### New changes predicates

It is possible to search for changes by uploader, using the new
[`uploader` and `uploaderin`](https://gerrit-documentation.storage.googleapis.com/Documentation/3.5.0/user-search.html#uploader)
predicates.

Hashtags search is improved with [`inhashtag`](https://gerrit-documentation.storage.googleapis.com/Documentation/3.5.0/user-search.html#inhashtag)
predicate which returns all the changes where any hashtag contains a substring,
using a full-text search.

Searching for attention-set changes supports now the
[`has:attention` and `is:attention` predicates](https://gerrit-documentation.storage.googleapis.com/Documentation/3.5.0/user-search.html#has-attention)
which returns all the changes where the attention-set by the current user.

Cherry-picked changes are now returned using the
[`is:cherrypick`](https://gerrit-documentation.storage.googleapis.com/Documentation/3.5.0/user-search.html#cherrypick)
predicate.

### Performance improvements on the change screen

The change screen has been improved by enabling extra caching and disabling
some expensive computation.

A new [`approvals` cache](https://gerrit-documentation.storage.googleapis.com/Documentation/3.5.0/config-gerrit.html#cache_names)
contains approvals for a given patch set.

The new [`change.conflictsPredicateEnabled`](https://gerrit-documentation.storage.googleapis.com/Documentation/3.5.0/config-gerrit.html#change.conflictsPredicateEnabled)
setting in `gerrit.config` disables the computation of the conflicts section
avoiding the computation of a complexity of O(nË†2).
When set to false GUI will silently ignore the error message and leave the
conflict changes section on change screen empty.

## Important notes

### Support for Java 8 dropped

The java language level is now set to Java 11 for Gerrit, the support
for Java 8 is dropped.

Gerrit source code may not be compatible with Java 8 anymore.

### Schema changes

This release doesn't contain schema changes since Gerrit v3.3.x, which means
that you can potentially upgrade directly skipping v3.4.x.

The changes index version has been increased to version 71. By default the
changes index is automatically rebuilt upon the Gerrit startup after the
upgrade.

To run off-line reindexing of the changes (optional):

```sh
  java -jar gerrit.war reindex --index changes -d site_path
```

### Zero-downtime upgrade

Gerrit supports zero-downtime upgrade from Gerrit v3.3.x or v3.4.x when
configured using a [high-availability configuration](https://gerrit.googlesource.com/plugins/high-availability/+/refs/heads/master/README.md),
and the Git repositories are stored in a shared filesystem such as NFS or
similar.

During the zero-downtime upgrade, Gerrit end-users would not notice any outage
or service disruption. They will be able to perform any read/write Gerrit
operation on the GUI or using the Git protocol.

The zero-downtime upgrade consists of the following steps:

1. Have Gerrit servers upgraded to v3.3.x or v3.4.x in high-availability
   configuration, healthy and able to handle the incoming traffic properly.
2. Set the Gerrit server unhealthy.
3. Shutdown the Gerrit server, update gerrit.war and plugins to v3.5.x and start
   Gerrit again.
4. Verify that the Gerrit server is working properly (e.g. run automated smoke
   tests) and then make it healthy again.
5. Wait for the Gerrit server to start serving traffic normally.
6. Repeat steps 2. to 5. for all the secondary Gerrit servers.

### Downgrade

Downgrade to any Gerrit v3.3.x or v3.4.x release is possible, but requires the
following manual steps:

1. Shutdown a migrated Gerrit v3.5.x servers
2. Update the gerrit.war and plugins to the previous v3.3.x or v3.4.x version
3. Run off-line reindexing using the previous gerrit.war version
3. Startup Gerrit server

### Breaking changes

* The support for [ElasticSearch index](https://gerrit-documentation.storage.googleapis.com/Documentation/3.4.1/config-gerrit.html#elasticsearch)
  is removed from Gerrit core. Existing setups can still use ElasticSearch through
  external non-core libModules.

* The "Reply" button label and tooltip cannot be customized anymore: the
  `change.replyLabel` and `change.replyTooltip` are ignored.

* The `repo_download` [`download.scheme`](https://gerrit-documentation.storage.googleapis.com/Documentation/3.5.0/config-gerrit.html#download.scheme)
  is renamed to `repo`.

* The `bower` Bazel rules are removed: all front-end plugins would have to
  migrate to `yarn`.

### Other changes

* Request tracing can exclude URI patterns, using the
  [`tracing.traceid.excludedRequestUriPattern`](https://gerrit-documentation.storage.googleapis.com/Documentation/3.5.0/config-gerrit.html#tracing.traceid.requestUriPattern)
  setting in `gerrit.config`.

* Git receive-pack can have a grace-period configurable as
[`receive.cancellationTimeout` setting](https://gerrit-documentation.storage.googleapis.com/Documentation/3.5.0/config-gerrit.html#receive.cancellationTimeout)
  for terminating after having received the cancellation signal from the client.

* Attention-set rules can be disabled upon push, using the
  [`--ignore-automatic-attention-set-rules` or `%ias` option](https://gerrit-documentation.storage.googleapis.com/Documentation/3.5.0/user-upload.html#ignore-attention-set).

### REST APIs

* [`AccountExternalIdInfo`](https://gerrit-documentation.storage.googleapis.com/Documentation/3.5.0/rest-api-accounts.html#account-external-id-info)
  `email` field is renamed to `email_address`.

* The `/accounts/link:#account-id[\{account-id\}]/stars.changes` endpoint
  is removed. Looking for starred changes is still available through the use
  of `is:starred` or `has:star` predicates.

## Plugin changes

* codemirror-editor
-Subproject commit aa2edb431337cc935659ab69d95ca7555cbc787e
+Subproject commit c5bda5b6b5fe91a2f7cd40c5a917dd2280b04814

* commit-message-length-validator: 
-Subproject commit 556e427fd737744ce8a6a37b89fd427ae59bc8ea
+Subproject commit c38e0a9d36767092b20558b28eff7f546c6d754c

* delete-project:
-Subproject commit 549de033d60b13aaeef45ce5c4bf42be39506268
+Subproject commit 5dcb1a64e779def0309354dd0e9886189845b020

* download-commands:
-Subproject commit 5bd359c08e10b93d2c08762f75cde01a14e45fc6
+Subproject commit d2f0cae51a269ca660f221172cf010e2d528b661

* gitiles
-Subproject commit e7a4e5521d59abaf6942c48f52bbe9e4bec1bf29
+Subproject commit 8e016364bfbaa30f957e14250f73d1c25bb006b4

* hooks
-Subproject commit ad4f877749928b69ef94b62176c5797f6648887d
+Subproject commit 4e07d16a644ea823f6538a176621acee466d865b

* plugin-manager
-Subproject commit 00e57948f4f112c226028bc5c8d8fe60f770038f
+Subproject commit e0664f668ab5bac96a1e105b80d886de66743b1b

* replication
-Subproject commit 7d9ba0d543e8212b73d8cf8e2e2d5764b63b7678
+Subproject commit 639ea4b3a3b3a67c80d29a6f83130499686543d3

* reviewnotes
-Subproject commit fb0390a8b49f0d601e11f8a1ac0658c429727f21
+Subproject commit a28ae590486934690e4e0a95d7eb75f8b60644a6

* singleusergroup
-Subproject commit 09623b9432d360060f88ae48fb3386e374ca29c0
+Subproject commit 3239ce3a471f5aa9edd8f6f702bee655ea81f77d

* webhooks
-Subproject commit 9fc9c2d4e69f7e2701cbcd873977d3312a231a81
+Subproject commit 9e4cd708b96e4fab79b4101eaf3f3e6a8b872dca


## Gerrit UI changes

**TBC**

## Documentation changes

* PolyGerrit UI screenshots and associated documentation has been updated.

## JGit changes

**TBC**

## Other dependency changes

* Update auto-value-gson-\* to 1.3.1

* Update testcontainers to 1.15.3

* Update flogger to 0.6

* Update docker-java-\* to 3.2.8

* Update lucene-\* to 6.6.5

* Update polymer/decorators to 3.0.0

* Update polymer to 3.4.1

* Update typescript-api to 3.4.4

* Update lit to 2.0.2

## Other core changes

**TBC**