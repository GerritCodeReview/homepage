{
  "comments": [
    {
      "key": {
        "uuid": "1bb21b82_68906798",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2019-10-17T07:13:14Z",
      "side": 1,
      "message": "Overall, there are hints to the implementation you have in mind \"leaking\" into the use-cases. That is fine, however, they should just be moved into the solution document.",
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fa0d45ae_e1821db3",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2019-10-17T23:14:47Z",
      "side": 1,
      "message": "Could you point out where? To be clear, I don\u0027t consider \"adding more nodes\" as a solution to the fact that \"adding more nodes doesn\u0027t help scale destinations\" (the problem).",
      "parentUuid": "1bb21b82_68906798",
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c3c7fa5d_524c1ad8",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 11,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2019-10-17T06:56:41Z",
      "side": 1,
      "message": "Can you share your current limits?\n- number of repos\n- number of destinations\n- number of ref-updates / hour, globally and per-repo\n- specs of the Gerrit master (# cores, RAM)\n\nUnderstanding your current limits and the associated bottlenecks would help selecting the right design for it.",
      "range": {
        "startLine": 11,
        "startChar": 14,
        "endLine": 11,
        "endChar": 33
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9d9e1967_1ac3450d",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 11,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2019-10-17T23:14:47Z",
      "side": 1,
      "message": "I have added the following to the sections where I thought appropriate:\n\n* number of repos\n* specs of the Gerrit master (# cores, RAM)\n\nLines 17 and 40 explain that we currently are limited to 5 destinations, the details of why we are limited come down to the CPU and memory limits described below.\n\nAs for the number of ref-updates / hour, globally and per-repo, I believe we have on average around on 6K replication tasks per hour. In my experience, in a well balanced master setup the aggregated ref updates get distributed across nodes, so admins can already handle adding more aggregate updates by adding more master nodes. While adding more destinations will increase the aggregate, I don\u0027t believe we have issues with aggregate throughput. Evidence that the aggregate is not a problem for us is that during normal operation we tend to see between 10 and 30 replication pushes per server across 3 servers running concurrently. This use case is more about handling the extra bursts, not the extra aggregate that adding extra destinations causes because the bursts currently get handled by a single master no matter how many you have in your cluster. While this data may be interesting, I don\u0027t think it is directly related to the use case, so I have not added it to the doc.\n\n\u003e Understanding your current limits and the associated bottlenecks would help selecting the right design for it.\n\nLet me know if there are more specifics of my use case\u0027s bottlenecks that you feel need more highlighting.",
      "parentUuid": "c3c7fa5d_524c1ad8",
      "range": {
        "startLine": 11,
        "startChar": 14,
        "endLine": 11,
        "endChar": 33
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f9a26a1a_a2860971",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 40,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2019-10-17T06:56:41Z",
      "side": 1,
      "message": "40 threads isn\u0027t that much for nowadays servers.",
      "range": {
        "startLine": 40,
        "startChar": 78,
        "endLine": 40,
        "endChar": 88
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4dd191b6_d96b7484",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 40,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2019-10-17T23:14:47Z",
      "side": 1,
      "message": "The use case is about allowing admins to scale destination support by adding more of the same servers, not by upgrading their hardware.",
      "parentUuid": "f9a26a1a_a2860971",
      "range": {
        "startLine": 40,
        "startChar": 78,
        "endLine": 40,
        "endChar": 88
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a80e5125_b3b3e3cf",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 40,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2019-10-18T16:14:04Z",
      "side": 1,
      "message": "oh, so basically the use case is *without* adding more resources how can you do more.\n\nwe should then remove the reference to adding nodes, which would open the objection “if you buy new hardware to get new nodes, just buy them bigger”",
      "parentUuid": "4dd191b6_d96b7484",
      "range": {
        "startLine": 40,
        "startChar": 78,
        "endLine": 40,
        "endChar": 88
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3d642300_4b7f86fe",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 40,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2019-10-18T16:31:29Z",
      "side": 1,
      "message": "I think you may have miss-read this reply. The admin wants to add more nodes of the same size as the original (i.e. horizontal scaling), the admin does not want to upgrade the original node (vertical scaling).",
      "parentUuid": "a80e5125_b3b3e3cf",
      "range": {
        "startLine": 40,
        "startChar": 78,
        "endLine": 40,
        "endChar": 88
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1caaf7db_60aa3e34",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 40,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2019-10-18T19:21:34Z",
      "side": 1,
      "message": "\u003e I think you may have miss-read this reply. The admin wants to add more nodes of the same size as the original (i.e. horizontal scaling), the admin does not want to upgrade the original node (vertical scaling).\n\nApologies, and yes, I believe I am struggling to understand the use-case and thanks for helping me out understanding the context, much appreciated.\n\nIn order to improve the scalability, the Gerrit admin should first understand where the bottleneck is. It could well be that the repo is just too big for the \"size\" of the current node. One solution to the problem could then be to off-load the replication task to a much bigger node (not the same size of the main one) so that can have more parallelism and memory to do that job more effectively.\n\n*If* (BIG IF) the problem is the overall size of the repo you are replicating (too many refs? too many blobs? too many binaries?) then adding more nodes of the same size of the original wouldn\u0027t really help that much.\n\nIs the use-case \"a Gerrit admin that does not want to add more nodes of a bigger size of the main one\"? If yes, then that Gerrit admin should spend more time understanding the real bottleneck and plan the future resources to allocate accordingly.",
      "parentUuid": "3d642300_4b7f86fe",
      "range": {
        "startLine": 40,
        "startChar": 78,
        "endLine": 40,
        "endChar": 88
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "aec79572_70c90225",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 42,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2019-10-17T07:13:14Z",
      "side": 1,
      "message": "10 destinations x 9 threads \u003d 90 threads, which still seems compatible with a large-scale server (e.g. 512 cores)",
      "range": {
        "startLine": 42,
        "startChar": 55,
        "endLine": 42,
        "endChar": 64
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "368ace34_bef7fc13",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 42,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2019-10-17T23:14:47Z",
      "side": 1,
      "message": "The use case is about allowing admins to scale destination support by adding more of the same servers (no matter whether they have 1 core or 512 cores).",
      "parentUuid": "aec79572_70c90225",
      "range": {
        "startLine": 42,
        "startChar": 55,
        "endLine": 42,
        "endChar": 64
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0ce55129_fc8e0a0e",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 42,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2019-10-18T19:21:34Z",
      "side": 1,
      "message": "That is the solution, not the problem. The problem is allowing to scale destinations. The solution *could* be adding more nodes with the same specs *OR* adding less nodes of higher specs *OR* upgrading the current nodes.\n\nWe should not put ONE possible solution into the use-case, otherwise we will limit our spectrum of choice of the best design.",
      "parentUuid": "368ace34_bef7fc13",
      "range": {
        "startLine": 42,
        "startChar": 55,
        "endLine": 42,
        "endChar": 64
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "38747c99_4c04e088",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 45,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2019-10-17T07:13:14Z",
      "side": 1,
      "message": "Yes, fully agreed. They just increase the contentions on the shared resources.",
      "range": {
        "startLine": 44,
        "startChar": 32,
        "endLine": 45,
        "endChar": 14
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6988f61a_486493fa",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 47,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2019-10-17T07:13:14Z",
      "side": 1,
      "message": "Can you share them so that we have more context?",
      "range": {
        "startLine": 47,
        "startChar": 48,
        "endLine": 47,
        "endChar": 78
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "94d4a192_d3ef7e65",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 47,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2019-10-17T23:14:47Z",
      "side": 1,
      "message": "Sure, I\u0027ve added our specifics to the sections on CPUs and memory as I don\u0027t want to detract from the generic problem of not being able to scale by adding more nodes (i.e. the use case is assuming that it is not considered problematic if an individual node\u0027s limits have been reached)",
      "parentUuid": "6988f61a_486493fa",
      "range": {
        "startLine": 47,
        "startChar": 48,
        "endLine": 47,
        "endChar": 78
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4f016b7c_a7ae9cc5",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 54,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2019-10-17T07:13:14Z",
      "side": 1,
      "message": "Is this possibly the problem? I recall you mentioned that your repos have hundreds of thousands of refs and, without Git protocol v2, the refs-advertisement phase would be huge.",
      "range": {
        "startLine": 54,
        "startChar": 44,
        "endLine": 54,
        "endChar": 74
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "82f35924_af8a6091",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 54,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2019-10-17T23:14:47Z",
      "side": 1,
      "message": "Yes problematic projects are my problem since it is in the section where I am describing this as a problem. :) I describe some of the reasons below.",
      "parentUuid": "4f016b7c_a7ae9cc5",
      "range": {
        "startLine": 54,
        "startChar": 44,
        "endLine": 54,
        "endChar": 74
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0f141183_b637b97e",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 62,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2019-10-17T07:13:14Z",
      "side": 1,
      "message": "This is the use-case, whilst here you mention the solution. This statement should be moved into a solution description section.",
      "range": {
        "startLine": 62,
        "startChar": 66,
        "endLine": 62,
        "endChar": 93
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3fb7ab4d_01d436d6",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 62,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2019-10-17T23:14:47Z",
      "side": 1,
      "message": "I have framed the use case from the point of view of an admin. The use case is about empowering admins to scale their systems by adding more nodes, to empower them to scale without having to alter the software or hardware do more with a single node with the assumption that systems will continue to grow to exceed the capacity of a single node.\n\nCurrently the architecture does not scale when \"adding more master nodes\", thus \"adding more master nodes\" cannot be a solution to the problem that \"the architecture does not scale when adding more master nodes\".",
      "parentUuid": "0f141183_b637b97e",
      "range": {
        "startLine": 62,
        "startChar": 66,
        "endLine": 62,
        "endChar": 93
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d6ac814a_d3f151e4",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 62,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2019-10-18T16:14:04Z",
      "side": 1,
      "message": "If you add more nodes it means you are changing the prerequisite of your use case and opens up the objection of the 512 core replication node.\n\nwe should define clear requirements and conditions, saying that this design addresses the problem of maximising throughput without adding new hardware.",
      "parentUuid": "3fb7ab4d_01d436d6",
      "range": {
        "startLine": 62,
        "startChar": 66,
        "endLine": 62,
        "endChar": 93
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0068eddb_da6e73e5",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 62,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2019-10-18T16:31:29Z",
      "side": 1,
      "message": "I think you miss-understood one of my replies above. This line is exactly what the use case is intending to do.",
      "parentUuid": "d6ac814a_d3f151e4",
      "range": {
        "startLine": 62,
        "startChar": 66,
        "endLine": 62,
        "endChar": 93
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a4e7d12a_67506592",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 62,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2019-10-18T19:21:34Z",
      "side": 1,
      "message": "Apologies, I believe I have now understood (I hope) and added my comments up.\nThank you for your patience.",
      "parentUuid": "0068eddb_da6e73e5",
      "range": {
        "startLine": 62,
        "startChar": 66,
        "endLine": 62,
        "endChar": 93
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "45fecfd8_a7e0b3be",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 63,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2019-10-17T05:59:36Z",
      "side": 1,
      "message": "Even if you keep on adding more masters, you won\u0027t solve the concurrency issues on the same repo on NFS.\nAlready with 2 nodes, you have problems when two nodes are reading/writing to the same repo. If you scale up to 10-15-20 or over, the NFS would just become unbearable.\n\nI believe you need to get rid of the shared filesystem if you would like to scale up, including the replication side.\n\nAlternatively, seems obvious, but just buy more powerful hardware. It is not uncommon to see hosts with 512 or more CPUs. That would NOT increase the complexity of the replication plugin (which is WAY too high at the moment) and would be less risky.\n\nHaving said that, your use-case at Qualcomm could be different because your shared NFS, I believe, has caching disabled and directly fire-channel connected to the nodes. But in that case, also, adding more nodes with direct cables could be challenging, unless you add 10-20x network cards to the shared NFS.",
      "range": {
        "startLine": 63,
        "startChar": 4,
        "endLine": 63,
        "endChar": 75
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0507d8db_1745d366",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 63,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2019-10-17T23:14:47Z",
      "side": 1,
      "message": "NFS scaling is not a problem for us, we know how to do that. On lines 89-90, I mention that an admin will need to be able to scale these types of limits (i.e. this use case is assuming the admin can do that). If you believe that you need to scale this limit, I would propose uploading a different use case doc to do so as this is out of the scope of this use case.",
      "parentUuid": "45fecfd8_a7e0b3be",
      "range": {
        "startLine": 63,
        "startChar": 4,
        "endLine": 63,
        "endChar": 75
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f0b82a18_2a1b2c93",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 63,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2019-10-18T16:14:04Z",
      "side": 1,
      "message": "I know high performance NFS is not a problem for Qualcomm, but it could be for everyone else in the world.\n\nwe should make the design useful for most people in the world.",
      "parentUuid": "0507d8db_1745d366",
      "range": {
        "startLine": 63,
        "startChar": 4,
        "endLine": 63,
        "endChar": 75
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c732e456_3933f9e3",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 63,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2019-10-18T16:31:29Z",
      "side": 1,
      "message": "I suspect that most people don\u0027t have issues scaling NFS, my use case will add value for us, and hopefully some others without solving that problem.",
      "parentUuid": "f0b82a18_2a1b2c93",
      "range": {
        "startLine": 63,
        "startChar": 4,
        "endLine": 63,
        "endChar": 75
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4caf9060_5d1ec7a8",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 63,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2019-10-18T19:21:34Z",
      "side": 1,
      "message": "Agreed, any improvement should be beneficial for the maximum number of use-cases, including yours in the first place.\n\nWith regards to NFS, it would be useful if you could add some specs and benchmarks in the solution part and guide other people on how can they achieve equal performance.\n\nIn my experience, not every Gerrit admin has the possibility to chose the implementation of the NFS (for budget reasons, or company policies) and, unfortunately, they cannot do so much about it.",
      "parentUuid": "c732e456_3933f9e3",
      "range": {
        "startLine": 63,
        "startChar": 4,
        "endLine": 63,
        "endChar": 75
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9afc2219_d8edce85",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 63,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2019-10-18T20:48:50Z",
      "side": 1,
      "message": "Can we please continue any discussions about scaling NFS somewhere else?",
      "parentUuid": "4caf9060_5d1ec7a8",
      "range": {
        "startLine": 63,
        "startChar": 4,
        "endLine": 63,
        "endChar": 75
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f450e231_b783fb43",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 63,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2019-10-18T21:32:45Z",
      "side": 1,
      "message": "\u003e Can we please continue any discussions about scaling NFS somewhere else?\n\nI believe it is relevant: having the wrong implementation of the NFS sharing would compromise the scalability of the solution. We need to know what are the underlying requirements of the shared storage that make this design effective.",
      "parentUuid": "9afc2219_d8edce85",
      "range": {
        "startLine": 63,
        "startChar": 4,
        "endLine": 63,
        "endChar": 75
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b5e3de13_eacafe11",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 63,
      "author": {
        "id": 1004034
      },
      "writtenOn": "2019-10-18T22:32:51Z",
      "side": 1,
      "message": "I think that this use case will be also relevant when using other shared filesystem implementations\nlike e.g. GlusterFS or Ceph.\n\nWe clearly also see a need for improved horizontal scalability in Kubernetes deployments of Gerrit\nwe are working on in [1]. As pods requesting huge amount of memory have disadvantages the need for\nhorizontal scalability regarding memory and compute will rather increase when running Gerrit on Kubernetes.\nAnd from our experience with horizontal and vertical pod auto-scaler in Gardener/Kubernetes I can say\nthat auto-scaling horizontally has advantages over vertical auto-scaling. E.g. scheduling many\nsmaller pods on a given node group is easier than with few large pods. Also the blast radius of failing\nlarger pods is larger than with a failing smaller pod.\n\n[1] https://gerrit.googlesource.com/k8s-gerrit/",
      "parentUuid": "f450e231_b783fb43",
      "range": {
        "startLine": 63,
        "startChar": 4,
        "endLine": 63,
        "endChar": 75
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "aed3ae83_7a12cc04",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 63,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2019-10-18T23:12:56Z",
      "side": 1,
      "message": "I have added a small note on how I believe the shared FS resource will be affected by adding more destinations under the section \"How do resource limits affect replication quality?\". I believe that is all that this doc needs to address with respect to the FS.",
      "parentUuid": "b5e3de13_eacafe11",
      "range": {
        "startLine": 63,
        "startChar": 4,
        "endLine": 63,
        "endChar": 75
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f54a4bf2_bdd63530",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 69,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2019-10-17T07:13:14Z",
      "side": 1,
      "message": "The replication plugin supports auto-reload of new destinations. We can work in making it differential so that the impact on existing replication tasks will be absolutely zero.",
      "range": {
        "startLine": 69,
        "startChar": 3,
        "endLine": 69,
        "endChar": 85
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0133d06d_6b07bf54",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 69,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2019-10-17T23:14:47Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "f54a4bf2_bdd63530",
      "range": {
        "startLine": 69,
        "startChar": 3,
        "endLine": 69,
        "endChar": 85
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "389d536e_8f9e53fc",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 86,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2019-10-17T07:13:14Z",
      "side": 1,
      "message": "The number of refs in a repo and the overall size of the new BLOBs are another *significant* limit to the replication system.",
      "range": {
        "startLine": 86,
        "startChar": 37,
        "endLine": 86,
        "endChar": 57
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a5d3d944_5e5a5f98",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 86,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2019-10-17T23:14:47Z",
      "side": 1,
      "message": "The things that you are listing are not resource limits, they are data/inputs which are limited by the available resources. This use case is not trying to address how the limits on those inputs can be increased.",
      "parentUuid": "389d536e_8f9e53fc",
      "range": {
        "startLine": 86,
        "startChar": 37,
        "endLine": 86,
        "endChar": 57
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5fedc4d6_e9e0e756",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 170,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2019-10-17T07:13:14Z",
      "side": 1,
      "message": "Why do you need to share them? You could distribute to the nodes without having to share them. (e.g. sharding)",
      "range": {
        "startLine": 170,
        "startChar": 38,
        "endLine": 170,
        "endChar": 67
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "56c10c5d_ae38e3a0",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 170,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2019-10-17T23:14:47Z",
      "side": 1,
      "message": "I have re-ordered this section since it seemed like I was offering a solution, which was not the intent of this section, rather it was to point out what might be seen as an obvious \"solution via configuration\" would not work. Hopefully the problems I was trying to point out stand out better now.",
      "parentUuid": "5fedc4d6_e9e0e756",
      "range": {
        "startLine": 170,
        "startChar": 38,
        "endLine": 170,
        "endChar": 67
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a096b4c7_e121db34",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 173,
      "author": {
        "id": 1004034
      },
      "writtenOn": "2019-10-11T16:18:53Z",
      "side": 1,
      "message": "so task files are not written to a temp file and then atomically renamed like JGit e.g. does\nwhen writing pack files or checking out a version ?",
      "range": {
        "startLine": 173,
        "startChar": 30,
        "endLine": 173,
        "endChar": 66
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0ede87db_50dd977a",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 173,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2019-10-11T17:09:14Z",
      "side": 1,
      "message": "Correct, that is why my solution addresses both of these shortcomings first.",
      "parentUuid": "a096b4c7_e121db34",
      "range": {
        "startLine": 173,
        "startChar": 30,
        "endLine": 173,
        "endChar": 66
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "509c21a0_543357b2",
        "filename": "pages/design-docs/scaling-multi-master-replication/use-cases.md",
        "patchSetId": 8
      },
      "lineNbr": 173,
      "author": {
        "id": 1004034
      },
      "writtenOn": "2019-10-11T17:39:10Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "0ede87db_50dd977a",
      "range": {
        "startLine": 173,
        "startChar": 30,
        "endLine": 173,
        "endChar": 66
      },
      "revId": "36775c4c7e09333992db724b99739c263c012692",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}