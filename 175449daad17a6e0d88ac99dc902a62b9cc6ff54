{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "d1a96fc9_74b070c8",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2021-04-29T16:01:57Z",
      "side": 1,
      "message": "I\u0027m confused by the +1s from folks here. Can you clarify what your +1s mean? I typically expect +1 to be \"This is good and complete, but waiting for others to review too\" or \"This is good and mostly complete, but there\u0027s a small nit or something like that\". Han-Wen/Luca/Patrick, does that match how you\u0027re using +1?",
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f0bce690_43b6f0be",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-04-30T00:56:40Z",
      "side": 1,
      "message": "+1 (for me at least) means \"I like the change and I believe it should go forward, but I am not convinced is ready yet to be merged and I (or other reviewers) am willing to give you constructive feedback to improve it\".",
      "parentUuid": "d1a96fc9_74b070c8",
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "df24b22f_8394e103",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-05-03T14:30:29Z",
      "side": 1,
      "message": "thanks for the comments!\nFYI the review internally with out customers is taking some time, so I\u0027ll resolve those comments soon.",
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5a3735b3_9b5a895e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2021-05-05T20:52:53Z",
      "side": 1,
      "message": "Thanks Luca! Han-Wen/Patrick, does that match your usage?",
      "parentUuid": "f0bce690_43b6f0be",
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ec7527fc_d4a9595e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1026112
      },
      "writtenOn": "2021-05-06T13:26:03Z",
      "side": 1,
      "message": "My +1 means \"I have read the use case and support it.\" It also matches the use case we have at Google. Thanks for checking back!\n\nMy +1 is not a +2 because there are open comments and it seems the discussion has not yet wrapped up.",
      "parentUuid": "5a3735b3_9b5a895e",
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4dd3addc_6ea2a5e0",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-05-17T08:32:32Z",
      "side": 1,
      "message": "another update here: discussed with customers internally and it looks like we\u0027re going to try to solve a different problem with a different solution. Due to vacations I will not be very active, but if anyone wants a comment to any comment in this design, please ask me specifically.\n\nIf we go with the problem/solution we currently have in mind, I think a design doc is not necessary since it\u0027s just a small improvement: Every REST endpoint will have list of changed refs in the response header (this will let users call Gerrit less and be prone to replication lags less, so the problem in this design still exists but we\u0027re not really solving it).",
      "parentUuid": "df24b22f_8394e103",
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6f158ba4_9ac7114c",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 11,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-04-29T01:08:07Z",
      "side": 1,
      "message": "multi-site",
      "range": {
        "startLine": 11,
        "startChar": 3,
        "endLine": 11,
        "endChar": 15
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "62cd5cd9_a92bd849",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 11,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2021-04-29T15:58:44Z",
      "side": 1,
      "message": "Is this all generic to any multi-site setup (like what you\u0027d have using https://gerrit.googlesource.com/plugins/multi-site) or specific to Google\u0027s setup? If the latter, that should noted up front here \"In Google\u0027s multi-site setup\".",
      "range": {
        "startLine": 11,
        "startChar": 0,
        "endLine": 11,
        "endChar": 21
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8d99d4f6_ebebf2dc",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 13,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2021-04-29T15:58:44Z",
      "side": 1,
      "message": "created?",
      "range": {
        "startLine": 13,
        "startChar": 7,
        "endLine": 13,
        "endChar": 15
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "798c102b_844c2ab1",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 15,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2021-05-13T04:47:14Z",
      "side": 1,
      "message": "participate",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 15,
        "endChar": 9
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a315a43f_d8029e64",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 16,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2021-05-13T04:47:14Z",
      "side": 1,
      "message": "Can you clarify this a bit, where the replication lag is coming from exactly? Dave Borowitz explained us how multi-primary/pull replication works at googlesource.com:\n\n1. Client performs git push operation\n2. Europe data center is processing this transaction\n3. In the process, it asks other data centers to pull this SHA1\n4. Another data center, say US East Coast, should pull this SHA1\n\nSo, the problem is that #4 is done asynchronously?",
      "range": {
        "startLine": 14,
        "startChar": 38,
        "endLine": 16,
        "endChar": 34
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3ca4d8eb_67072935",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 24,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-04-29T01:08:07Z",
      "side": 1,
      "message": "Multi-site",
      "range": {
        "startLine": 24,
        "startChar": 17,
        "endLine": 24,
        "endChar": 29
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2e0a1e0e_96f9f2df",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 24,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-04-29T01:08:07Z",
      "side": 1,
      "message": "What is a multi-primary? To me the wording doesn\u0027t make so much sense.\nEither primary-replica or HA-cluster ... did we define multi-primary anywhere?",
      "range": {
        "startLine": 24,
        "startChar": 39,
        "endLine": 24,
        "endChar": 52
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "784385f1_fbaf30c8",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 24,
      "author": {
        "id": 1024147
      },
      "writtenOn": "2021-04-29T08:20:23Z",
      "side": 1,
      "message": "fwiw, Edwin has always described googlesource.com as a \"multi-master\". The precise setup is described in l.11-22",
      "parentUuid": "3ca4d8eb_67072935",
      "range": {
        "startLine": 24,
        "startChar": 17,
        "endLine": 24,
        "endChar": 29
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8ec2c4c1_cad40a7b",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 24,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2021-04-29T08:43:34Z",
      "side": 1,
      "message": "but nowadays we try to avoid the term \"master\"",
      "parentUuid": "784385f1_fbaf30c8",
      "range": {
        "startLine": 24,
        "startChar": 17,
        "endLine": 24,
        "endChar": 29
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d3da4636_eccf446d",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 24,
      "author": {
        "id": 1024147
      },
      "writtenOn": "2021-04-29T13:02:41Z",
      "side": 1,
      "message": "oh, right. Multi-site it is then. Not sure what multi-primary is, though.",
      "parentUuid": "8ec2c4c1_cad40a7b",
      "range": {
        "startLine": 24,
        "startChar": 17,
        "endLine": 24,
        "endChar": 29
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0931f724_101e6db2",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 24,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2021-04-29T15:58:44Z",
      "side": 1,
      "message": "I guess it is needed in the glossary. 😊\n\nSee my answer in https://gerrit-review.googlesource.com/c/homepage/+/303793/comment/2e0a1e0e_96f9f2df/",
      "parentUuid": "d3da4636_eccf446d",
      "range": {
        "startLine": 24,
        "startChar": 17,
        "endLine": 24,
        "endChar": 29
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "176d8d72_884d1774",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 24,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2021-04-29T15:58:44Z",
      "side": 1,
      "message": "A \"primary\" is the new preferred team vs a \"master\". So multi-primary replaces multi-master as a cluster of primaries cooperating in a single site (I think there\u0027s a glossary doc now in Gerrit, so I\u0027ll add this). Multi-site is the further extension of that where you have multiple sites each with a multi-primary cluster.",
      "parentUuid": "2e0a1e0e_96f9f2df",
      "range": {
        "startLine": 24,
        "startChar": 39,
        "endLine": 24,
        "endChar": 52
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "34dd3f3a_2d2bd3c3",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 24,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2021-04-29T20:25:49Z",
      "side": 1,
      "message": "Done in https://gerrit-review.googlesource.com/c/gerrit/+/304642",
      "parentUuid": "176d8d72_884d1774",
      "range": {
        "startLine": 24,
        "startChar": 39,
        "endLine": 24,
        "endChar": 52
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "26f1f538_2dfcd80b",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 24,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-04-30T00:56:40Z",
      "side": 1,
      "message": "Ack, shall we keep this comment open until Change 304642 is merged?",
      "parentUuid": "34dd3f3a_2d2bd3c3",
      "range": {
        "startLine": 24,
        "startChar": 39,
        "endLine": 24,
        "endChar": 52
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8533155a_2b4ef0b1",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 24,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2021-05-05T20:52:53Z",
      "side": 1,
      "message": "Sure.",
      "parentUuid": "26f1f538_2dfcd80b",
      "range": {
        "startLine": 24,
        "startChar": 39,
        "endLine": 24,
        "endChar": 52
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "272d47fd_f551ce89",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 25,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-04-29T01:08:07Z",
      "side": 1,
      "message": "multi-site",
      "range": {
        "startLine": 25,
        "startChar": 59,
        "endLine": 25,
        "endChar": 71
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d1ea865c_d23351e2",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 26,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-04-29T01:08:07Z",
      "side": 1,
      "message": "Really hours? If one data-centre is behind by a few hours, I would rather consider to shut it down or marking it unhealthy.",
      "range": {
        "startLine": 26,
        "startChar": 46,
        "endLine": 26,
        "endChar": 55
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b5c8e051_93ed6e12",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 26,
      "author": {
        "id": 1026112
      },
      "writtenOn": "2021-05-06T13:26:03Z",
      "side": 1,
      "message": "I\u0027d also rather say \"seconds, sometimes minutes\".",
      "parentUuid": "d1ea865c_d23351e2",
      "range": {
        "startLine": 26,
        "startChar": 46,
        "endLine": 26,
        "endChar": 55
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "91b3ea94_3a4753f5",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 26,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2021-05-13T04:47:14Z",
      "side": 1,
      "message": "It\u0027s not clear to me why it would be minutes, not to mention hours? The observation for Gerrit CI located in Canada, is that it\u0027s failing to fetch SHA1 that I pushed to data center located in the EU in ca. 25% of cases. We are talking about seconds here: re-triggering the build verification only few seconds later after the failure always solves the problem.",
      "parentUuid": "b5c8e051_93ed6e12",
      "range": {
        "startLine": 26,
        "startChar": 46,
        "endLine": 26,
        "endChar": 55
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "349aff7c_ec6bebcb",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 28,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-04-29T01:08:07Z",
      "side": 1,
      "message": "A \"globally inconsistent\" view, because from a local data-centre perspective it should be still be consistent, or not?",
      "range": {
        "startLine": 28,
        "startChar": 0,
        "endLine": 28,
        "endChar": 33
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "330394d8_b121c537",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 29,
      "author": {
        "id": 1024147
      },
      "writtenOn": "2021-04-28T09:34:24Z",
      "side": 1,
      "message": "may be\n\nnon-existent or nonexistent",
      "range": {
        "startLine": 29,
        "startChar": 14,
        "endLine": 29,
        "endChar": 17
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e1fbf0ca_0ed57111",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 34,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2021-04-29T15:58:44Z",
      "side": 1,
      "message": "Could this be worded as: \"Replication lag causes corrupt automated releases because it presents an inconsistent state to the automation client\" ?\n\nAlso, can you describe how exactly replication lag and/or inconsistent state corrupts releases? Probably needs to start with describing what is a corrupt release. Or is this the Background section? That didn\u0027t look like a release flow to me, so maybe I\u0027m just confused.",
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fce1900a_76125f8a",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 34,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2021-05-13T04:47:14Z",
      "side": 1,
      "message": "\u003e an inconsistent state that could lead to corrupt releases.\n\nI don\u0027t follow. If I don\u0027t have a SHA1 and the fetch operation is failing, I can\u0027t build. I will definitely not end up with corrupt release. In fact I will fail to produce any release, and that\u0027s a good thing.",
      "parentUuid": "e1fbf0ca_0ed57111",
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "31872c49_97e4d94e",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 34,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-05-14T00:41:07Z",
      "side": 1,
      "message": "I believe Google uses the global-refdb like GerritHub.io, which allows to detect the inconsistencies and returning a \"lock-failure\" and avoiding to end up into a corrupted state.",
      "parentUuid": "fce1900a_76125f8a",
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b3672f66_60380f8c",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 35,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2021-04-29T15:58:44Z",
      "side": 1,
      "message": "What are the common replication lag symptoms? Can they be added as sub-bullets here?",
      "range": {
        "startLine": 35,
        "startChar": 41,
        "endLine": 35,
        "endChar": 72
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "093f540f_a27e664d",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 35,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2021-05-13T04:47:14Z",
      "side": 1,
      "message": "\u003e What are the common replication lag symptoms?\n\nAnother data center is trying to fetch the SHA1 and is failing.",
      "parentUuid": "b3672f66_60380f8c",
      "range": {
        "startLine": 35,
        "startChar": 41,
        "endLine": 35,
        "endChar": 72
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "258c0293_8390dc64",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 35,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-05-14T00:41:07Z",
      "side": 1,
      "message": "Some numbers on the % of incidence would be needed. Are we talking about a rare scenario or something that is happening on a regular basis?\n\nWhy the geo-based routing won\u0027t help here?\n\nOn GerritHub.io a replication lag isn\u0027t an issue because we assure a local site consistency: even if you see a \"picture of the past\" it is locally consistent and it will eventually catch-up.\n\nWe also measure the replication lag with a specific metric (plugins_multi_site_multi_site_subscriber_subscriber_replication_status_sec_behind) so that can be reported and alarmed on.",
      "parentUuid": "093f540f_a27e664d",
      "range": {
        "startLine": 35,
        "startChar": 41,
        "endLine": 35,
        "endChar": 72
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2743a4e0_b8d59d41",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 46,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2021-04-29T15:58:44Z",
      "side": 1,
      "message": "There\u0027s no aim to improve Gerrit software for this use case?",
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d7def4e5_0b7904c5",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 52,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2021-05-13T04:47:14Z",
      "side": 1,
      "message": "Failures are really good in this context: I want to fail ASAP. One thing I must avoid: produce broken final artifact. This statement is also a contradiction with statement on line 34:\n\n  \"Replication lag causes corrupt automated releases because it presents an inconsistent state to the automation client\"",
      "range": {
        "startLine": 52,
        "startChar": 20,
        "endLine": 52,
        "endChar": 40
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c27eb98a_dd58ce68",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 54,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2021-05-13T04:47:14Z",
      "side": 1,
      "message": "How this sequence proposal is related to the issue with Gerrit CI, located in Canada that is failing to fetch SHA1 from the change that I pushed to data center located in the EU? If it wouldn\u0027t solve it, can you add a new section in this document to outline your suggestion how to address the Gerrit CI specific use case:\n\nProblem:\n\n* 1. install gerrit on googlesource.com with checks plugin\n* 2. have two data center: EU and US East Coast\n* 3. push a CL to EU data center (GEO location of the developer: Munich, Germany)\n* 4. checks plugins is reporting pending checks\n* 5. CI job is triggered and is trying to fetch the SHA1 for the pending check from the US East Coast data center (GEO location of the CI: Toronto, Canada)\n* 6. It will fail approximately in 25% of cases (with SHA1 unknown error).\n\nSolution: [...] (hopefully not wait and retry loop on the CI side?)",
      "range": {
        "startLine": 54,
        "startChar": 0,
        "endLine": 54,
        "endChar": 32
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "34881362_25569fc8",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 56,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2021-04-29T15:58:44Z",
      "side": 1,
      "message": "Are you trying to list atomic operations on each line? If so, I think creating a branch in two different repos is non-atomic, so use two lines here?",
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "46e585ef_9816d9b0",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 66,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2021-04-29T15:58:44Z",
      "side": 1,
      "message": "What does \"currently used\" mean here? Can you have an index that\u0027s not used?",
      "range": {
        "startLine": 66,
        "startChar": 18,
        "endLine": 66,
        "endChar": 32
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f30dbbe7_eb43993e",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 68,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2021-05-13T04:47:14Z",
      "side": 1,
      "message": "Is this the bottom line, of \"Consistency on Demand\" design document:\n\n  It\u0027s impossible to solve: \"Go and implement wait and retry loop on the CI side\".\n\n?\n\nGerrit CI is using checks plugin. Why the pending-checks REST endpoint: [1] in checks plugin is telling CI located in Canada, that there are some pending checks for specific change waiting to be built, but when the CI it\u0027s trying to fetch that SHA1 it\u0027s failing? See this efforts to synchronize gerrit primary/replica with ref-replicated event in Jenkins gerrit-trigger plugin: [2],[3],[4], to off-load clones to replicas. The CI would only try to fetch from the replicas if CI got ref-replicated event.\n\nIOW, couldn\u0027t we make pending-checks REST endpoint outcome a bit smarter, and only return pending checks for specific change waiting to be built, iff the SHA1 is already available (and if it is not available, just not report the pending checks for that change, but report it in next pending-checks POLL request round)? Wouldn\u0027t this be a trivial change in checks plugin, instead of telling Gerrit users: \"Go and implement wait and retry loop on the CI side\"?\n\n[1] https://gerrit.googlesource.com/plugins/checks/+/refs/heads/master/resources/Documentation/rest-api-pending-checks.md\n[2] https://gerrit-review.googlesource.com/c/plugins/replication/+/51200\n[3] https://gerrit-review.googlesource.com/c/plugins/replication/+/50920\n[4] https://github.com/jenkinsci/gerrit-trigger-plugin/commit/18afecf11282a66e6c1b94d387e6048d52a17735",
      "range": {
        "startLine": 68,
        "startChar": 0,
        "endLine": 68,
        "endChar": 65
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "325e3469_7af423d4",
        "filename": "pages/design-docs/consistency-on-demand/use-cases.md",
        "patchSetId": 4
      },
      "lineNbr": 69,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2021-05-13T04:47:14Z",
      "side": 1,
      "message": "The failure is always due to replication lag. At least on gerrit-review. If I re-trigger the failed build job only seconds after the failure, it would always succeed.",
      "range": {
        "startLine": 69,
        "startChar": 0,
        "endLine": 69,
        "endChar": 46
      },
      "revId": "175449daad17a6e0d88ac99dc902a62b9cc6ff54",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}